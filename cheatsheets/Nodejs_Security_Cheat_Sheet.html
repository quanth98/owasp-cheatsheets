        ---
        redirect_from: "/cheatsheets/Nodejs_security_cheat_sheet.html"
        ---
        
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Website with the collection of all the cheat sheets of the project.">
      
      
      
        <link rel="canonical" href="https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html">
      
      
        <link rel="prev" href="NodeJS_Docker_Cheat_Sheet.html">
      
      
        <link rel="next" href="OAuth2_Cheat_Sheet.html">
      
      
      <link rel="icon" href="../assets/WebSite_Favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.3.2">
    
    
      
        <title>Nodejs Security - OWASP Cheat Sheet Series</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.30068a00.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-header__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Cheat Sheet Series
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Nodejs Security Cheat Sheet
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-nav__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    OWASP Cheat Sheet Series
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../Glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexMASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexMASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexProactiveControls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexProactiveControls
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexTopTen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexTopTen
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="AJAX_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AJAX Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Abuse_Case_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abuse Case Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Access_Control_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Attack_Surface_Analysis_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack Surface Analysis Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Testing_Automation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Testing Automation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Bean_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bean Validation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="C-Based_Toolchain_Hardening_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C Based Toolchain Hardening Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="CI_CD_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI CD Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Choosing_and_Using_Security_Questions_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing and Using Security Questions Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Clickjacking_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clickjacking Defense Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Content_Security_Policy_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Security Policy Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Credential_Stuffing_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Stuffing Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Request Forgery Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Cryptographic_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographic Storage Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="DOM_Clobbering_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM Clobbering Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="DOM_based_XSS_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Database_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Denial_of_Service_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denial of Service Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Deserialization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deserialization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Django_REST_Framework_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django REST Framework Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Django_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Docker_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="DotNet_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DotNet Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Error_Handling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="File_Upload_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Upload Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Forgot_Password_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forgot Password Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="GraphQL_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="HTML5_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML5 Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Headers_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Headers Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Strict Transport Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Infrastructure_as_Code_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_in_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention in Java Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Input_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Validation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="JAAS_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAAS Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="JSON_Web_Token_for_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Web Token for Java Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Java_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Key_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Kubernetes_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="LDAP_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Injection Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Laravel_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laravel Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Vocabulary_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Vocabulary Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Mass_Assignment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass Assignment Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_based_Security_Arch_Doc_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices based Security Arch Doc Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Mobile_Application_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mobile Application Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Multifactor_Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="NPM_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPM Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Network_Segmentation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Segmentation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="NodeJS_Docker_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Docker Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Nodejs Security Cheat Sheet
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Nodejs_Security_Cheat_Sheet.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Nodejs Security Cheat Sheet
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    Context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    Recommendations
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-security" class="md-nav__link">
    Application Security
  </a>
  
    <nav class="md-nav" aria-label="Application Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-flat-promise-chains" class="md-nav__link">
    Use flat Promise chains
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-request-size-limits" class="md-nav__link">
    Set request size limits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-block-the-event-loop" class="md-nav__link">
    Do not block the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-input-validation" class="md-nav__link">
    Perform input validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-output-escaping" class="md-nav__link">
    Perform output escaping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-application-activity-logging" class="md-nav__link">
    Perform application activity logging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-the-event-loop" class="md-nav__link">
    Monitor the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take-precautions-against-brute-forcing" class="md-nav__link">
    Take precautions against brute-forcing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-anti-csrf-tokens" class="md-nav__link">
    Use Anti-CSRF tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-unnecessary-routes" class="md-nav__link">
    Remove unnecessary routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prevent-http-parameter-pollution" class="md-nav__link">
    Prevent HTTP Parameter Pollution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-return-what-is-necessary" class="md-nav__link">
    Only return what is necessary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-object-property-descriptors" class="md-nav__link">
    Use object property descriptors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-access-control-lists" class="md-nav__link">
    Use access control lists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-exception-handling" class="md-nav__link">
    Error &amp; Exception Handling
  </a>
  
    <nav class="md-nav" aria-label="Error & Exception Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#handle-uncaughtexception" class="md-nav__link">
    Handle uncaughtException
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listen-to-errors-when-using-eventemitter" class="md-nav__link">
    Listen to errors when using EventEmitter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-errors-in-asynchronous-calls" class="md-nav__link">
    Handle errors in asynchronous calls
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-security" class="md-nav__link">
    Server Security
  </a>
  
    <nav class="md-nav" aria-label="Server Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-cookie-flags-appropriately" class="md-nav__link">
    Set cookie flags appropriately
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-appropriate-security-headers" class="md-nav__link">
    Use appropriate security headers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#platform-security" class="md-nav__link">
    Platform Security
  </a>
  
    <nav class="md-nav" aria-label="Platform Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-your-packages-up-to-date" class="md-nav__link">
    Keep your packages up-to-date
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-use-dangerous-functions" class="md-nav__link">
    Do not use dangerous functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stay-away-from-evil-regexes" class="md-nav__link">
    Stay away from evil regexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-security-linters" class="md-nav__link">
    Run security linters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-strict-mode" class="md-nav__link">
    Use strict mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adhere-to-general-application-security-principles" class="md-nav__link">
    Adhere to general application security principles
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources-about-nodejs-security" class="md-nav__link">
    Additional resources about Node.js security
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="OAuth2_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2 Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="OS_Command_Injection_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Command Injection Defense Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="PHP_Configuration_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP Configuration Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Password_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Storage Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Pinning_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinning Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Prototype_Pollution_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype Pollution Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Query_Parameterization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Parameterization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="REST_Assessment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Assessment Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="REST_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Ruby_on_Rails_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby on Rails Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="SAML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="SQL_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Secrets_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Cloud_Architecture_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Cloud Architecture Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Product_Design_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Product Design Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Securing_Cascading_Style_Sheets_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Securing Cascading Style Sheets Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Request Forgery Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Session_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Software_Supply_Chain_Security.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Supply Chain Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Symfony_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symfony Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="TLS_Cipher_String_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Cipher String Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Third_Party_Javascript_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third Party Javascript Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Threat_Modeling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threat Modeling Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Transaction_Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transaction Authorization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Protection Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unvalidated Redirects and Forwards Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="User_Privacy_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Privacy Protection Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Virtual_Patching_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Patching Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerability_Disclosure_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Disclosure Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Dependency Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Web_Service_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Service Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XML_External_Entity_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XSS_Filter_Evasion_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS Filter Evasion Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XS_Leaks_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XS Leaks Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    Context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    Recommendations
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-security" class="md-nav__link">
    Application Security
  </a>
  
    <nav class="md-nav" aria-label="Application Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-flat-promise-chains" class="md-nav__link">
    Use flat Promise chains
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-request-size-limits" class="md-nav__link">
    Set request size limits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-block-the-event-loop" class="md-nav__link">
    Do not block the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-input-validation" class="md-nav__link">
    Perform input validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-output-escaping" class="md-nav__link">
    Perform output escaping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-application-activity-logging" class="md-nav__link">
    Perform application activity logging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-the-event-loop" class="md-nav__link">
    Monitor the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take-precautions-against-brute-forcing" class="md-nav__link">
    Take precautions against brute-forcing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-anti-csrf-tokens" class="md-nav__link">
    Use Anti-CSRF tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-unnecessary-routes" class="md-nav__link">
    Remove unnecessary routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prevent-http-parameter-pollution" class="md-nav__link">
    Prevent HTTP Parameter Pollution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-return-what-is-necessary" class="md-nav__link">
    Only return what is necessary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-object-property-descriptors" class="md-nav__link">
    Use object property descriptors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-access-control-lists" class="md-nav__link">
    Use access control lists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-exception-handling" class="md-nav__link">
    Error &amp; Exception Handling
  </a>
  
    <nav class="md-nav" aria-label="Error & Exception Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#handle-uncaughtexception" class="md-nav__link">
    Handle uncaughtException
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listen-to-errors-when-using-eventemitter" class="md-nav__link">
    Listen to errors when using EventEmitter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-errors-in-asynchronous-calls" class="md-nav__link">
    Handle errors in asynchronous calls
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-security" class="md-nav__link">
    Server Security
  </a>
  
    <nav class="md-nav" aria-label="Server Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-cookie-flags-appropriately" class="md-nav__link">
    Set cookie flags appropriately
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-appropriate-security-headers" class="md-nav__link">
    Use appropriate security headers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#platform-security" class="md-nav__link">
    Platform Security
  </a>
  
    <nav class="md-nav" aria-label="Platform Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-your-packages-up-to-date" class="md-nav__link">
    Keep your packages up-to-date
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-use-dangerous-functions" class="md-nav__link">
    Do not use dangerous functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stay-away-from-evil-regexes" class="md-nav__link">
    Stay away from evil regexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-security-linters" class="md-nav__link">
    Run security linters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-strict-mode" class="md-nav__link">
    Use strict mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adhere-to-general-application-security-principles" class="md-nav__link">
    Adhere to general application security principles
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources-about-nodejs-security" class="md-nav__link">
    Additional resources about Node.js security
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Nodejs Security Cheat Sheet</h1>

<div class="highlight"><pre><span></span><code>        Title: Nodejs Security
        # NodeJS Security Cheat Sheet
</code></pre></div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<!-- This cheat sheet lists actions developers can take to develop secure Node.js applications. Each item has a brief explanation and solution that is specific to the Node.js environment. -->

<p>Cheat sheet ny s lit k cc action m developer c th lm cho nodejs app bo mt hn. Mi item c mt v d ngn gn gii thch v gii php c ch nh trong mi trng nodejs</p>
<h2 id="context">Context<a class="headerlink" href="#context" title="Permanent link">&para;</a></h2>
<!-- Node.js applications are increasing in number and they are no different from other frameworks and programming languages. Node.js applications are prone to all kinds of web application vulnerabilities. -->

<p>Cc ng dng Node.js ngy cng tng v s lng v chng khng khc g cc framework v ngn ng lp trnh khc. Cc ng dng Node.js d gp phi tt c cc loi l hng ng dng web.</p>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">&para;</a></h2>
<!-- This cheat sheet aims to provide a list of best practices to follow during development of Node.js applications. -->

<p>Ti liu ny nhm cung cp danh sch cc thc tin tt nht  tun theo trong qu trnh pht trin ng dng Node.js.</p>
<h2 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permanent link">&para;</a></h2>
<!-- There are several recommendations to enhance security of your Node.js applications. These are categorized as: -->

<p>C mt s khuyn ngh  nng cao bo mt cho ng dng Node.js ca bn. Chng c phn loi nh sau:</p>
<ul>
<li><strong>Application Security</strong></li>
<li><strong>Error &amp; Exception Handling</strong></li>
<li><strong>Server Security</strong></li>
<li><strong>Platform Security</strong></li>
</ul>
<h3 id="application-security">Application Security<a class="headerlink" href="#application-security" title="Permanent link">&para;</a></h3>
<h4 id="use-flat-promise-chains">Use flat Promise chains<a class="headerlink" href="#use-flat-promise-chains" title="Permanent link">&para;</a></h4>
<!-- Asynchronous callback functions are one of the strongest features of Node.js. However, increasing layers of nesting within callback functions can become a problem. Any multistage process can become nested 10 or more levels deep. This problem is referred to as a "Pyramid of Doom" or "Callback Hell". In such code, the errors and results get lost within the callback. Promises are a good way to write asynchronous code without getting into nested pyramids. Promises provide top-down execution while being asynchronous by delivering errors and results to next `.then` function. -->

<p>Cc hm callback bt ng b l mt trong nhng tnh nng mnh m nht ca Node.js. Tuy nhin, vic tng cc lp lng nhau trong cc hm callback c th tr thnh mt vn . Bt k quy trnh a giai on no cng c th b lng nhau su 10 cp hoc hn. Vn  ny c gi l "Pyramid of Doom" (Kim t thp ca s dit vong) hoc "callback hell"(a ngc callback). Trong m nh vy, li v kt qu b mt trong callback. Promises l mt cch tt  vit m bt ng b m khng b lng vo cc kim t thp. Promises cung cp thc thi t trn xung trong khi vn bt ng b bng cch chuyn li v kt qu cho hm .then tip theo.</p>
<!-- Another advantage of Promises is the way Promises handle errors. If an error occurs in a Promise class, it skips over the `.then` functions and invokes the first `.catch` function it finds. This way Promises provide a higher assurance of capturing and handling errors. As a principle, you can make all your asynchronous code (apart from emitters) return promises. It should be noted that Promise calls can also become a pyramid. In order to completely stay away from "Callback Hell", flat Promise chains should be used. If the module you are using does not support Promises, you can convert base object to a Promise by using `Promise.promisifyAll()` function. -->

<p>Mt li th khc ca Promises l cch Promises x l li. Nu li xy ra trong mt lp Promise, n s b qua cc hm .then v gi hm .catch u tin m n tm thy. Bng cch ny, Promises cung cp mc  m bo cao hn v vic nm bt v x l li. Theo nguyn tc, bn c th khin tt c m bt ng b ca mnh (ngoi tr cc b pht) tr v cc li ha. Cn lu  rng cc cuc gi Promise cng c th tr thnh mt kim t thp.  trnh hon ton "Callback Hell", nn s dng cc chui Promise phng. Nu m-un bn ang s dng khng h tr Promises, bn c th chuyn i i tng c s thnh mt Promise bng cch s dng hm Promise.promisifyAll().</p>
<p>The following code snippet is an example of "Callback Hell":</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>

<span class="nx">func1</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result1</span><span class="p">){</span>
<span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">      </span><span class="c1">// error operations</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">//some operations</span>
<span class="w">      </span><span class="nx">func2</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result2</span><span class="p">){</span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">            </span><span class="c1">//error operations</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="k">else</span><span class="p">{</span>
<span class="w">            </span><span class="c1">//some operations</span>
<span class="w">            </span><span class="nx">func3</span><span class="p">(</span><span class="s2">&quot;input3&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result3</span><span class="p">){</span>
<span class="w">               </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">                  </span><span class="c1">//error operations</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span><span class="k">else</span><span class="p">{</span>
<span class="w">                  </span><span class="c1">// some operations</span>
<span class="w">                  </span><span class="nx">func4</span><span class="p">(</span><span class="s2">&quot;input 4&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result4</span><span class="p">){</span>
<span class="w">                     </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">                        </span><span class="c1">// error operations</span>
<span class="w">                     </span><span class="p">}</span>
<span class="w">                     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// some operations</span>
<span class="w">                     </span><span class="p">}</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>The above code can be securely written as follows using a flat Promise chain:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>

<span class="nx">func1</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">)</span>
<span class="w">   </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="p">})</span>
<span class="w">   </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="s2">&quot;input3&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="p">})</span>
<span class="w">   </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="s2">&quot;input4&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="p">})</span>
<span class="w">   </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// error operations</span>
<span class="w">   </span><span class="p">});</span>
</code></pre></div>
<p>And using async/await:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>

<span class="p">(</span><span class="k">async</span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// error operations</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})();</span>
</code></pre></div>
<h4 id="set-request-size-limits">Set request size limits<a class="headerlink" href="#set-request-size-limits" title="Permanent link">&para;</a></h4>
<p>Vic lu vo b nh m v phn tch c php cc ni dung yu cu c th l mt nhim v tn nhiu ti nguyn. Nu khng c gii hn v kch thc yu cu, k tn cng c th gi yu cu c ni dung yu cu ln c th lm cn kit b nh my ch v/hoc lp y dung lng  a. Bn c th gii hn kch thc ni dung yu cu cho tt c cc yu cu bng cch s <a href="https://www.npmjs.com/package/raw-body">raw-body</a>.</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">contentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">getRawBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;raw-body&#39;</span><span class="p">)</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">()</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DELETE&#39;</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">next</span><span class="p">()</span>
<span class="w">    </span><span class="k">return</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">getRawBody</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;content-length&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1kb&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="nx">contentType</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">).</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">charset</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">next</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="nx">req</span><span class="p">.</span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">string</span>
<span class="w">    </span><span class="nx">next</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</code></pre></div>
<p>Tuy nhin, vic c nh gii hn kch thc yu cu cho tt c cc yu cu c th khng phi l hnh vi chnh xc, v mt s yu cu c th c ti trng ln trong thn yu cu, chng hn nh khi ti ln tp. Ngoi ra, u vo vi kiu JSON nguy him hn u vo a phn, v phn tch c php JSON l mt hot ng chn. Do , bn nn t gii hn kch thc yu cu cho cc loi ni dung khc nhau. Bn c th thc hin iu ny rt d dng vi middleware express nh sau:</p>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span><span class="w"> </span><span class="nx">extended</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1kb&quot;</span><span class="w"> </span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1kb&quot;</span><span class="w"> </span><span class="p">}));</span>
</code></pre></div>
<p>Cn lu  rng k tn cng c th thay i Content-Type header ca request v b qua gii hn kch thc request. Do , trc khi x l request, d liu cha trong request phi c xc thc da trn loi ni dung c nu trong request headers. Nu vic xc thc loi ni dung cho tng request nh hng nghim trng n hiu sut, bn ch c th xc thc cc loi ni dung c th hoc yu cu ln hn kch thc xc nh trc.</p>
<h4 id="do-not-block-the-event-loop">Do not block the event loop<a class="headerlink" href="#do-not-block-the-event-loop" title="Permanent link">&para;</a></h4>
<p>Node.js rt khc so vi cc ng dng s dng lung. Node.js c kin trc hng s kin n lung. Bng kin trc ny, thng lng tr nn cao v m hnh lp trnh tr nn n gin hn. Node.js c trin khai xung quanh non-blocking I/O event loop. Vi event loop, bn khng phi ch i I/O hoc chuyn i ng cnh. Vng lp s kin tm kim cc s kin v gi chng n cc hm x l. Do , khi cc hot ng JavaScript chuyn su ca CPU c thc thi, vng lp s kin s i chng kt thc. y l l do ti sao cc hot ng nh vy c gi l "blocking".  khc phc s c ny, Node.js cho php gn callback cho cc s kin b chn IO. Bng cch ny, ng dng chnh khng b chn v callback chy khng ng b. Do , theo nguyn tc chung, tt c cc hot ng chn phi c thc hin khng ng b  vng lp s kin khng b chn.</p>
<p>Ngay c khi bn thc hin cc thao tc chn khng ng b, ng dng ca bn vn c th khng phc v nh mong i. iu ny xy ra nu c mt m bn ngoi callback da vo m trong callback  chy trc. V d: hy xem xt m sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// perform actions on file content</span>
<span class="p">});</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">unlinkSync</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Trong v d trn, hm unlinkSync c th chy trc khi callback, hm ny s xa tp trc khi cc hnh ng mong mun trn ni dung tp c thc hin. Cc iu kin ua nh vy cng c th nh hng n tnh bo mt ca ng dng ca bn. Mt v d s l mt kch bn trong  xc thc c thc hin trong mt cuc gi li v cc hnh ng c xc thc c chy ng b.  loi b cc iu kin ua nh vy, bn c th vit tt c cc hot ng da vo nhau trong mt chc nng khng chn duy nht. Bng cch , bn c th m bo rng tt c cc hot ng c thc hin theo ng th t. V d, v d v code trn c th c vit theo cch khng chn nh sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// perform actions on file content</span>
<span class="w">  </span><span class="nx">fs</span><span class="p">.</span><span class="nx">unlink</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="nx">err</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<p>Trong on m trn, lnh gi  hy lin kt tp v cc thao tc tp khc nm trong cng mt cuc gi li. iu ny cung cp th t hot ng chnh xc.</p>
<h4 id="perform-input-validation">Perform input validation<a class="headerlink" href="#perform-input-validation" title="Permanent link">&para;</a></h4>
<p>Xc thc u vo l mt phn quan trng ca bo mt ng dng. Li xc thc u vo c th dn n nhiu loi tn cng ng dng. Chng bao gm SQL Injection, Cross-Site Scripting, Command Injection, Local / Remote File Inclusion, Denial of Service, Directory Traversal, LDAP Injection v nhiu cuc tn cng injection khc.  trnh nhng cuc tn cng ny, u vo cho ng dng ca bn nn c v sinh trc. K thut xc thc u vo tt nht l s dng danh sch cc u vo c chp nhn. Tuy nhin, nu iu ny l khng th, trc tin cn kim tra u vo so vi s  u vo d kin v cc u vo nguy him nn c thot.  d dng xc thc u vo trong cc ng dng Node.js, c mt s m-un nh <a href="https://www.npmjs.com/package/validator">validator</a> and <a href="https://www.npmjs.com/package/express-mongo-sanitize">express-mongo-sanitize</a>.
 bit thng tin chi tit v xc thc u vo, vui lng tham kho <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">Input Validation Cheat Sheet</a>.</p>
<p>JavaScript l mt ngn ng ng v ty thuc vo cch framework phn tch c php URL, d liu c nhn thy bi m ng dng c th c nhiu dng. Di y l mt s v d sau khi phn tch c php chui truy vn trong express.js:</p>
<table>
<thead>
<tr>
<th>URL</th>
<th>Content of request.query.foo in code</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>?foo=bar</code></td>
<td><code>'bar'</code> (string)</td>
</tr>
<tr>
<td><code>?foo=bar&amp;foo=baz</code></td>
<td><code>['bar', 'baz']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[]=bar</code></td>
<td><code>['bar']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[]=bar&amp;foo[]=baz</code></td>
<td><code>['bar', 'baz']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[bar]=baz</code></td>
<td><code>{ bar : 'baz' }</code> (object with a key)</td>
</tr>
<tr>
<td><code>?foo[]=bar</code></td>
<td><code>['bar']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[]baz=bar</code></td>
<td><code>['bar']</code> (array of string - postfix is lost)</td>
</tr>
<tr>
<td><code>?foo[][baz]=bar</code></td>
<td><code>[ { baz: 'bar' } ]</code> (array of object)</td>
</tr>
<tr>
<td><code>?foo[bar][baz]=bar</code></td>
<td><code>{ foo: { bar: { baz: 'bar' } } }</code> (object tree)</td>
</tr>
<tr>
<td><code>?foo[10]=bar&amp;foo[9]=baz</code></td>
<td><code>[ 'baz', 'bar' ]</code> (array of string - notice order)</td>
</tr>
<tr>
<td><code>?foo[toString]=bar</code></td>
<td><code>{}</code> (object where calling <code>toString()</code> will fail)</td>
</tr>
</tbody>
</table>
<h4 id="perform-output-escaping">Perform output escaping<a class="headerlink" href="#perform-output-escaping" title="Permanent link">&para;</a></h4>
<p>Ngoi vic xc thc u vo, bn nn thot tt c ni dung HTML v JavaScript c hin th cho ngi dng thng qua ng dng  ngn chn cc cuc tn cng cross-site scripting (XSS). Bn c th s dng <a href="https://github.com/component/escape-html">escape-html</a> or <a href="https://github.com/ESAPI/node-esapi">node-esapi</a> libraries  thc hin output escaping.</p>
<h4 id="perform-application-activity-logging">Perform application activity logging<a class="headerlink" href="#perform-application-activity-logging" title="Permanent link">&para;</a></h4>
<p>Ghi nht k hot ng ng dng l mt thc hnh tt c khuyn khch. N gip d dng g li bt k li no gp phi trong thi gian chy ng dng. N cng hu ch cho cc mi quan tm v bo mt, v n c th c s dng trong qu trnh ng ph s c. Ngoi ra, cc nht k ny c th c s dng  cung cp cho H thng Pht hin / Ngn chn Xm nhp (IDS / IPS). Trong Node.js, c cc m-un nh <a href="https://www.npmjs.com/package/winston">Winston</a>, <a href="https://www.npmjs.com/package/bunyan">Bunyan</a>, or <a href="https://www.npmjs.com/package/pino">Pino</a>  thc hin ghi log ng dng. Nhng module ny cho php streaming and querying logs, and chng cung cp mt cch  x l cc ngoi l khng b bt.</p>
<p>Vi on m sau, bn c th ghi li cc hot ng ca ng dng trong c bng iu khin v tp nht k mong mun:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="p">(</span><span class="nx">Winston</span><span class="p">.</span><span class="nx">Logger</span><span class="p">)</span><span class="w"> </span><span class="p">({</span>
<span class="w">    </span><span class="nx">transports</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="ow">new</span><span class="w"> </span><span class="p">(</span><span class="nx">winston</span><span class="p">.</span><span class="nx">transports</span><span class="p">.</span><span class="nx">Console</span><span class="p">)(),</span>
<span class="w">        </span><span class="ow">new</span><span class="w"> </span><span class="p">(</span><span class="nx">winston</span><span class="p">.</span><span class="nx">transports</span><span class="p">.</span><span class="nx">File</span><span class="p">)({</span><span class="w"> </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application.log&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;verbose&#39;</span>
<span class="p">});</span>
</code></pre></div>
<p>Bn c th cung cp cc phng tin truyn ti khc nhau  bn c th lu li vo tp nht k ring bit v nht k ng dng chung vo tp nht k khc. Thng tin b sung v ghi nht k bo mt c th c tm thy trong <a href="https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html">Logging Cheat Sheet</a>.</p>
<h4 id="monitor-the-event-loop">Monitor the event loop<a class="headerlink" href="#monitor-the-event-loop" title="Permanent link">&para;</a></h4>
<p>Khi my ch ng dng ca bn c lu lng mng ln, n c th khng phc v c ngi dng. y thc cht l mt loi <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Denial of Service (DoS)</a> attack. M-un <a href="https://www.npmjs.com/package/toobusy-js">toobusy-js</a> cho php bn theo di vng lp s kin. N theo di thi gian phn hi v khi vt qu mt ngng nht nh, m-un ny c th cho bit my ch ca bn qu bn. Trong trng hp , bn c th ngng x l cc yu cu n v gi cho chng thng bo <code>503 Server Too Busy</code>  ng dng ca bn lun phn hi. <a href="https://www.npmjs.com/package/toobusy-js">toobusy-js</a> module hin th  y</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">toobusy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;toobusy-js&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">toobusy</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// log if you see necessary</span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">503</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;Server Too Busy&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">next</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="take-precautions-against-brute-forcing">Take precautions against brute-forcing<a class="headerlink" href="#take-precautions-against-brute-forcing" title="Permanent link">&para;</a></h4>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#protect-against-automated-attacks">Brute-forcing</a> l mt mi e da ph bin i vi tt c cc ng dng web. Nhng k tn cng c th s dng brute-force nh mt cuc tn cng on mt khu  ly mt khu ti khon. Do , cc nh pht trin ng dng nn  phng cc cuc tn cng brute-force, c bit l trong cc trang ng nhp. Node.js c mt s m-un c sn cho mc ch ny <a href="https://libraries.io/npm/express-bouncer">Express-bouncer</a>, <a href="https://libraries.io/npm/express-brute">express-brute</a> and <a href="https://libraries.io/npm/rate-limiter">rate-limiter</a> ch l mt s v d. Da trn nhu cu v yu cu ca bn, bn nn chn mt hoc nhiu m-un ny v s dng cho ph hp. M-un <a href="https://libraries.io/npm/express-bouncer">Express-bouncer</a> v <a href="https://libraries.io/npm/express-brute">express-brute</a> hot ng tng t nhau. Chng lm tng  tr cho mi yu cu khng thnh cng v c th c sp xp cho mt tuyn ng c th. Cc m-un ny c th c s dng nh sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">bouncer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-bouncer&#39;</span><span class="p">);</span>
<span class="nx">bouncer</span><span class="p">.</span><span class="nx">whitelist</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// allow an IP address</span>
<span class="c1">// give a custom error message</span>
<span class="nx">bouncer</span><span class="p">.</span><span class="nx">blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">,</span><span class="w"> </span><span class="nx">remaining</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">429</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;Too many requests have been made. Please wait &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">remaining</span><span class="o">/</span><span class="mf">1000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; seconds.&quot;</span><span class="p">);</span>
<span class="p">};</span>
<span class="c1">// route to protect</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&quot;/login&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">bouncer</span><span class="p">.</span><span class="nx">block</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">LoginFailed</span><span class="p">){</span><span class="w">  </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">bouncer</span><span class="p">.</span><span class="nx">reset</span><span class="p">(</span><span class="w"> </span><span class="nx">req</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">ExpressBrute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-brute&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ExpressBrute</span><span class="p">.</span><span class="nx">MemoryStore</span><span class="p">();</span><span class="w"> </span><span class="c1">// stores state locally, don&#39;t use this in production</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">bruteforce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ExpressBrute</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/auth&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">bruteforce</span><span class="p">.</span><span class="nx">prevent</span><span class="p">,</span><span class="w"> </span><span class="c1">// error 429 if we hit this route too often</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Success!&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">);</span>
</code></pre></div>
<p>Ngoi <a href="https://libraries.io/npm/express-bouncer">express-bouncer</a> v <a href="https://libraries.io/npm/express-brute">express-brute</a>, m-un <a href="https://libraries.io/npm/rate-limiter">rate-limiter</a> cng c th gip ngn chn cc cuc tn cng brute-force. N cho php ch nh s lng yu cu m mt a ch IP c th c th thc hin trong mt khong thi gian xc nh.</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">limiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">RateLimiter</span><span class="p">();</span>
<span class="nx">limiter</span><span class="p">.</span><span class="nx">addLimit</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">500</span><span class="p">);</span><span class="w"> </span><span class="c1">// login page can be requested 5 times at max within 500 seconds</span>
</code></pre></div>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Credential_Stuffing_Prevention_Cheat_Sheet.html#captcha">S dng CAPTCHA</a> cng l mt c ch ph bin khc c s dng  chng li brute-forcing. C cc m-un c pht trin cho Node.js CAPTCHA. Mt m-un ph bin c s dng trong cc ng dng Node.js l <a href="https://www.npmjs.com/package/svg-captcha">svg-captcha</a>. N c th c s dng nh sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">svgCaptcha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;svg-captcha&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/captcha&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">captcha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">svgCaptcha</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="w">    </span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">captcha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">captcha</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="nx">captcha</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#account-lockout">Account lockout</a> l mt gii php c  xut  gi cho k tn cng trnh xa ngi dng hp l ca bn. C th kha ti khon vi nhiu m-un nh <a href="https://www.npmjs.com/package/mongoose">mongoose</a>. Bn c th tham kho <a href="http://devsmash.com/blog/implementing-max-login-attempts-with-mongoose">bi ng trn blog ny</a>  xem cch kha ti khon c thc hin trong.</p>
<h4 id="use-anti-csrf-tokens">Use Anti-CSRF tokens<a class="headerlink" href="#use-anti-csrf-tokens" title="Permanent link">&para;</a></h4>
<p><a href="https://owasp.org/www-community/attacks/csrf">Cross-Site Request Forgery (CSRF)</a> nhm mc ch thc hin cc hnh ng c y quyn thay mt cho ngi dng c xc thc, trong khi ngi dng khng bit v hnh ng ny. Cc cuc tn cng CSRF thng c thc hin cho cc yu cu thay i trng thi nh thay i mt khu, thm ngi dng hoc t hng. <a href="https://www.npmjs.com/package/csurf">Csurf</a> l mt phn mm trung gian nhanh  c s dng  gim thiu cc cuc tn cng CSRF. Nhng mt l hng bo mt trong gi ny gn y  c pht hin. Nhm ng sau gi cha khc phc l hng c pht hin v h  nh du gi l khng dng na, khuyn ngh s dng bt k gi bo v CSRF no khc.</p>
<p> bit thng tin chi tit v cc cuc tn cng gi mo yu cu cho trang web (CSRF) v cc phng php ngn chn, bn c th tham kho <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">Cross-Site Request Forgery Prevention</a>.</p>
<h4 id="remove-unnecessary-routes">Remove unnecessary routes<a class="headerlink" href="#remove-unnecessary-routes" title="Permanent link">&para;</a></h4>
<p>Mt ng dng web khng nn cha bt k trang no khng c ngi dng s dng, v n c th lm tng b mt tn cng ca ng dng. Do , tt c cc tuyn API khng s dng nn b v hiu ha trong cc ng dng Node.js. iu ny c bit xy ra trong cc framework nh <a href="https://sailsjs.com">Sails</a> v <a href="https://feathersjs.com">Feathers</a>, v chng t ng to cc im cui REST API. V d: Trong <a href="https://sailsjs.com">Sails</a>, nu URL khng khp vi tuyn ng ty chnh, URL  c th khp vi mt trong cc tuyn ng t ng v vn to phn hi. Tnh hung ny c th dn n cc kt qu khc nhau, t r r thng tin n thc thi lnh ty . Do , trc khi s dng cc khung v m-un nh vy, iu quan trng l phi bit cc tuyn m chng t ng to v xa hoc v hiu ha cc tuyn ny.</p>
<h4 id="prevent-http-parameter-pollution">Prevent HTTP Parameter Pollution<a class="headerlink" href="#prevent-http-parameter-pollution" title="Permanent link">&para;</a></h4>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution.html">HTTP Parameter Pollution(HPP)</a> l mt cuc tn cng trong  k tn cng gi nhiu tham s HTTP c cng tn v iu ny khin ng dng ca bn din gii chng mt cch khng th on trc. Khi nhiu gi tr tham s c gi, Express s in chng vo mt mng.  gii quyt vn  ny, bn c th s dng m-un <a href="https://www.npmjs.com/package/hpp">hpp</a> module. Khi c s dng, m-un ny s b qua tt c cc gi tr c gi cho mt tham s trong <code>req.query</code> and/or <code>req.body</code> v ch chn gi tr tham s cui cng c gi. Bn c th s dng n nh sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">hpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;hpp&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">hpp</span><span class="p">());</span>
</code></pre></div>
<h4 id="only-return-what-is-necessary">Only return what is necessary<a class="headerlink" href="#only-return-what-is-necessary" title="Permanent link">&para;</a></h4>
<p>Thng tin v ngi dng ca mt ng dng l mt trong nhng thng tin quan trng nht v ng dng. Bng ngi dng thng bao gm cc trng nh id, tn ngi dng, tn y , a ch email, ngy sinh, mt khu v trong mt s trng hp s an sinh x hi. Do , khi truy vn v s dng cc i tng ngi dng, bn ch cn tr v cc trng cn thit v n c th d b tit l thng tin c nhn. iu ny cng ng i vi cc i tng khc c lu tr trn c s d liu. Nu bn ch cn mt trng nht nh ca mt i tng, bn ch nn tr v cc trng c th c yu cu. V d: bn c th s dng mt hm nh sau bt c khi no bn cn ly thng tin v ngi dng. Bng cch , bn ch c th tr v cc trng cn thit cho hot ng c th ca mnh. Ni cch khc, nu bn ch cn lit k tn ca nhng ngi dng c sn, bn s khng tr li a ch email hoc s th tn dng ca h ngoi tn y  ca h.</p>
<div class="highlight"><pre><span></span><code><span class="nx">exports</span><span class="p">.</span><span class="nx">sanitizeUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
<span class="w">    </span><span class="nx">username</span><span class="o">:</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
<span class="w">    </span><span class="nx">fullName</span><span class="o">:</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">fullName</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>
</code></pre></div>
<h4 id="use-object-property-descriptors">Use object property descriptors<a class="headerlink" href="#use-object-property-descriptors" title="Permanent link">&para;</a></h4>
<p>Thuc tnh i tng bao gm ba thuc tnh n: <code>writable</code> (nu false, gi tr thuc tnh khng th thay i), <code>enumerable</code> (nu false, thuc tnh khng th c s dng cho cc vng lp) v <code>configurable</code> (nu false, thuc tnh khng th b xa). Khi xc nh mt thuc tnh i tng thng qua gn, ba thuc tnh n ny c t thnh true theo mc nh. Cc thuc tnh ny c th c t nh sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">writable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">enumerable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">configurable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span>
<span class="p">});</span>
</code></pre></div>
<p>Ngoi ra, c mt s chc nng c bit cho cc thuc tnh i tng. <code>Object.preventExtensions()</code> ngn khng cho cc thuc tnh mi c thm vo i tng.</p>
<h4 id="use-access-control-lists">Use access control lists<a class="headerlink" href="#use-access-control-lists" title="Permanent link">&para;</a></h4>
<p>y quyn ngn ngi dng hnh ng ngoi quyn d nh ca h.  lm nh vy, ngi dng v vai tr ca h nn c xc nh vi vic xem xt nguyn tc c quyn ti thiu. Mi vai tr ngi dng ch nn c quyn truy cp vo cc ti nguyn m h phi s dng. i vi cc ng dng Node.js ca bn, bn c th s dng m-un <a href="https://www.npmjs.com/package/acl">acl</a>  cung cp trin khai ACL (danh sch kim sot truy cp). Vi m-un ny, bn c th to vai tr v gn ngi dng cho cc vai tr ny.</p>
<h3 id="error-exception-handling">Error &amp; Exception Handling<a class="headerlink" href="#error-exception-handling" title="Permanent link">&para;</a></h3>
<h4 id="handle-uncaughtexception">Handle uncaughtException<a class="headerlink" href="#handle-uncaughtexception" title="Permanent link">&para;</a></h4>
<p>Node.js hnh vi cho cc ngoi l khng b bt l in du vt ngn xp hin ti v sau  chm dt lung. Tuy nhin, Node.js cho php ty chnh hnh vi ny. N cung cp mt i tng ton cu c tn l process c sn cho tt c cc ng dng Node.js. N l mt i tng EventEmitter v trong trng hp ngoi l khng b bt, s kin uncaughtException c pht ra v n c a ln vng lp s kin chnh.  cung cp hnh vi ty chnh cho cc trng hp ngoi l khng b bt, bn c th lin kt vi s kin ny. Tuy nhin, vic tip tc ng dng sau mt ngoi l khng b bt nh vy c th dn n cc vn  khc. Do , nu bn khng mun b l bt k ngoi l cha b bt no, bn nn lin kt vi s kin uncaughtException v dn dp mi ti nguyn c phn b nh m t tp, x l v tng t trc khi tt quy trnh. Vic tip tc ng dng khng c khuyn khch v ng dng s  trng thi khng xc nh. iu quan trng cn lu  l khi hin th thng bo li cho ngi dng trong trng hp ngoi l khng b bt, thng tin chi tit nh du vt ngn xp khng nn c tit l cho ngi dng. Thay vo , cc thng bo li ty chnh s c hin th cho ngi dng  khng gy ra bt k r r thng tin no.</p>
<div class="highlight"><pre><span></span><code><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;uncaughtException&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// clean up allocated resources</span>
<span class="w">    </span><span class="c1">// log necessary error details to log files</span>
<span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">();</span><span class="w"> </span><span class="c1">// exit the process to avoid unknown state</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="listen-to-errors-when-using-eventemitter">Listen to errors when using EventEmitter<a class="headerlink" href="#listen-to-errors-when-using-eventemitter" title="Permanent link">&para;</a></h4>
<p>Khi s dng EventEmitter, li c th xy ra  bt k u trong chui s kin. Thng thng, nu mt li xy ra trong mt i tng EventEmitter, mt s kin li c mt i tng Error lm i s c gi. Tuy nhin, nu khng c ngi nghe nh km vo s kin li , i tng Li c gi di dng i s s b nm v tr thnh ngoi l khng b bt. Ni tm li, nu bn khng x l li trong mt i tng EventEmitter ng cch, nhng li cha c x l ny c th lm sp ng dng ca bn. Do , bn nn lun lng nghe cc s kin li khi s dng cc i tng EventEmitter.</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;events&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">myEventEmitter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">events</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">require</span><span class="p">(</span><span class="s1">&#39;util&#39;</span><span class="p">).</span><span class="nx">inherits</span><span class="p">(</span><span class="nx">myEventEmitter</span><span class="p">,</span><span class="w"> </span><span class="nx">events</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">);</span>
<span class="nx">myEventEmitter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">someFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">param1</span><span class="p">,</span><span class="w"> </span><span class="nx">param2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//in case of an error</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">emitter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">myEventEmitter</span><span class="p">();</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">    </span><span class="c1">//Perform necessary error handling here</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="handle-errors-in-asynchronous-calls">Handle errors in asynchronous calls<a class="headerlink" href="#handle-errors-in-asynchronous-calls" title="Permanent link">&para;</a></h4>
<p>Cc li xy ra trong callback khng ng b rt d b b l. Do , nh mt nguyn tc chung, i s u tin cho cc cuc gi khng ng b phi l mt i tng Li. Ngoi ra, cc tuyn tc hnh t x l li, nhng cn lun nh rng cc li xy ra trong cc cuc gi khng ng b c thc hin trong cc tuyn tc hnh khng c x l, tr khi mt i tng Li c gi di dng i s u tin.</p>
<p>Li trong cc callback ny c th c lan truyn nhiu ln nht c th. Mi callback m li  c lan truyn c th b qua, x l hoc lan truyn li.</p>
<h3 id="server-security">Server Security<a class="headerlink" href="#server-security" title="Permanent link">&para;</a></h3>
<h4 id="set-cookie-flags-appropriately">Set cookie flags appropriately<a class="headerlink" href="#set-cookie-flags-appropriately" title="Permanent link">&para;</a></h4>
<p>Ni chung, thng tin phin c gi bng cookie trong cc ng dng web. Tuy nhin, vic s dng cookie HTTP khng ng cch c th khin ng dng gp mt s l hng qun l phin. Mt s c c th c t cho mi cookie  ngn chn cc loi tn cng ny. C <code>httpOnly</code>, <code>Secure</code> v <code>SameSite</code> rt quan trng i vi cookie phin. C <code>httpOnly</code> ngn khng cho cookie c truy cp bi JavaScript pha my khch. y l mt bin php i ph hiu qu cho cc cuc tn cng XSS. C <code>Secure</code> ch cho php cookie c gi nu giao tip qua HTTPS. C <code>SameSite</code> c th ngn cookie c gi trong cc yu cu cho trang web gip bo v chng li cc cuc tn cng Gi mo Yu cu Cho Trang web (CSRF). Ngoi ra, cn c cc c khc nh <code>domain</code>, <code>path</code> and <code>expires</code>. Vic t cc c ny mt cch thch hp c khuyn khch, nhng chng ch yu lin quan n phm vi cookie ch khng phi bo mt cookie. Vic s dng mu cc c ny c a ra trong v d sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-session&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">session</span><span class="p">({</span>
<span class="w">    </span><span class="nx">secret</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;your-secret-key&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;cookieName&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">cookie</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">secure</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">httpOnly</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;/user&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sameSite</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}</span>
<span class="p">}));</span>
</code></pre></div>
<h4 id="use-appropriate-security-headers">Use appropriate security headers<a class="headerlink" href="#use-appropriate-security-headers" title="Permanent link">&para;</a></h4>
<p>C mt s <a href="https://owasp.org/www-project-secure-headers/">HTTP security headers</a> c th gip bn ngn chn mt s vect tn cng ph bin.
Gi <a href="https://www.npmjs.com/package/helmet">helmet</a> c th gip thit lp cc tiu  :</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;express&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">helmet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;helmet&quot;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">());</span><span class="w"> </span><span class="c1">// Add various HTTP headers</span>
</code></pre></div>
<p>Gi <code>helmet</code> c bn s dng 14 middlewares nh.
Di y l danh sch cc tiu  bo mt HTTP c bao ph bi <code>helmet</code> middleware:</p>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">Strict-Transport-Security</a></strong>: <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html">HTTP Strict Transport Security (HSTS)</a> ra lnh cho cc trnh duyt rng ng dng ch c th c truy cp thng qua cc kt ni HTTPS.  s dng n trong ng dng ca bn, hy thm cc m sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hsts</span><span class="p">());</span><span class="w"> </span><span class="c1">// default configuration</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
<span class="w">  </span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hsts</span><span class="p">({</span>
<span class="w">    </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123456</span><span class="p">,</span>
<span class="w">    </span><span class="nx">includeSubDomains</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">);</span><span class="w"> </span><span class="c1">// custom configuration</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">X-Frame-Options</a>:</strong> xc nh xem mt trang c th c ti qua mt <code>&lt;frame&gt;</code> hoc phn t <code>&lt;iframe&gt;</code> hay khng. Cho php trang c ng khung c th dn n cc cuc tn cng <a href="https://owasp.org/www-community/attacks/Clickjacking">Clickjacking</a>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">frameguard</span><span class="p">());</span><span class="w"> </span><span class="c1">// default behavior (SAMEORIGIN)</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection">X-XSS-Protection</a>:</strong>  ngn cc trang ti khi chng pht hin cc cuc tn cng cross-site scripting (XSS) c phn x. Tiu  ny  b cc trnh duyt hin i phn i v vic s dng n c th gy ra cc vn  bo mt b sung  pha my khch. Do , nn t tiu  l <strong>X-XSS-Protection: 0</strong>  v hiu ha XSS Auditor v khng cho php n thc hin hnh vi mc nh ca trnh duyt x l phn hi.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">xssFilter</span><span class="p">());</span><span class="w"> </span><span class="c1">// sets &quot;X-XSS-Protection: 0&quot;</span>
</code></pre></div>
<p>i vi cc trnh duyt hin i, bn nn trin khai chnh sch <strong>Content-Security-Policy</strong> mnh m, nh c nu chi tit trong phn tip theo.</p>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">Content-Security-Policy</a>:</strong> Chnh sch bo mt ni dung c pht trin  gim nguy c b tn cng nh <a href="https://owasp.org/www-community/attacks/xss/">Cross-Site Scripting (XSS)</a> v <a href="https://owasp.org/www-community/attacks/Clickjacking">Clickjacking</a>. N cho php ni dung t mt danh sch m bn quyt nh. N c mt s ch th, mi ch th cm ti loi ni dung c th. Bn c th tham kho <a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html">Content Security Policy Cheat Sheet</a>  c gii thch chi tit v tng ch th v cch s dng n. Bn c th trin khai cc ci t ny trong ng dng ca mnh nh sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
<span class="w">  </span><span class="nx">helmet</span><span class="p">.</span><span class="nx">contentSecurityPolicy</span><span class="p">({</span>
<span class="w">    </span><span class="c1">// the following directives will be merged into the default helmet CSP policy</span>
<span class="w">    </span><span class="nx">directives</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">defaultSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">],</span><span class="w">  </span><span class="c1">// default value for all directives that are absent</span>
<span class="w">      </span><span class="nx">scriptSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">],</span><span class="w">   </span><span class="c1">// helps prevent XSS attacks</span>
<span class="w">      </span><span class="nx">frameAncestors</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">],</span><span class="w">  </span><span class="c1">// helps prevent Clickjacking attacks</span>
<span class="w">      </span><span class="nx">imgSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&#39;http://imgexample.com&#39;&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nx">styleSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">);</span>
</code></pre></div>
<p>V middleware ny thc hin rt t validation, nn da vo cc trnh kim tra CSP nh <a href="https://csp-evaluator.withgoogle.com/">CSP Evaluator</a>  thay th.</p>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options</a>:</strong> Ngay c khi my ch t tiu  <code>Content-Type</code> hp l trong phn hi, trnh duyt c th c gng nh hi loi MIME ca ti nguyn c yu cu. Tiu  ny l mt cch  ngn chn hnh vi ny v yu cu trnh duyt khng thay i loi MIME c ch nh trong tiu  <code>Content-Type</code>. N c th c cu hnh theo cch sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">noSniff</span><span class="p">());</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control">Cache-Control</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Pragma">Pragma</a>:</strong> Tiu  Cache-Control c th c s dng  ngn cc trnh duyt lu vo b nh m cc phn hi  cho. iu ny nn c thc hin cho cc trang c cha thng tin nhy cm v ngi dng hoc ng dng. Tuy nhin, vic tt b nh m cho cc trang khng cha thng tin nhy cm c th nh hng nghim trng n hiu sut ca ng dng. Do , ch nn tt b nh m cho cc trang tr v thng tin nhy cm. Cc iu khin v tiu  b nh m thch hp c th c t d dng bng gi <a href="https://www.npmjs.com/package/nocache">nocache</a>:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">nocache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;nocache&quot;</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">nocache</span><span class="p">());</span>
</code></pre></div>
<p>on code trn sets Cache-Control, Surrogate-Control, Pragma v Expires cho ph hp.</p>
<ul>
<li><strong>X-Download-Options:</strong> Tiu  ny ngn Internet Explorer thc thi cc tp  ti xung trong ng cnh ca trang web. iu ny t c vi ch th noopen. Bn c th lm nh vy vi on m sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">ieNoOpen</span><span class="p">());</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT">Expect-CT</a>:</strong> Tnh minh bch ca chng ch (Certificate Transparency) l mt c ch mi c pht trin  khc phc mt s vn  cu trc lin quan n c s h tng SSL hin ti. Tiu  Expect-CT c th thc thi cc yu cu v tnh minh bch ca chng ch. N c th c trin khai trong ng dng ca bn nh sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">expectCt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;expect-ct&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">expectCt</span><span class="p">({</span><span class="w"> </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123</span><span class="w"> </span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">expectCt</span><span class="p">({</span><span class="w"> </span><span class="nx">enforce</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123</span><span class="w"> </span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">expectCt</span><span class="p">({</span><span class="w"> </span><span class="nx">enforce</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123</span><span class="p">,</span><span class="w"> </span><span class="nx">reportUri</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://example.com&#39;</span><span class="p">}));</span>
</code></pre></div>
<ul>
<li><strong>X-Powered-By:</strong> X-Powered-By header c s dng  thng bo cng ngh no c s dng  pha my ch. y l mt tiu  khng cn thit gy r r thng tin, v vy n nn c loi b khi ng dng ca bn.  lm nh vy, bn c th s dng <code>hidePoweredBy</code> nh sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hidePoweredBy</span><span class="p">());</span>
</code></pre></div>
<p>Ngoi ra, bn c th ni di v cc cng ngh c s dng vi headers ny. V d: ngay c khi ng dng ca bn khng s dng PHP, bn cng c th t headers <code>X-Powered-By</code></p>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hidePoweredBy</span><span class="p">({</span><span class="w"> </span><span class="nx">setTo</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PHP 4.2.0&#39;</span><span class="w"> </span><span class="p">}));</span>
</code></pre></div>
<h3 id="platform-security">Platform Security<a class="headerlink" href="#platform-security" title="Permanent link">&para;</a></h3>
<h4 id="keep-your-packages-up-to-date">Keep your packages up-to-date<a class="headerlink" href="#keep-your-packages-up-to-date" title="Permanent link">&para;</a></h4>
<p>Tnh bo mt ca ng dng ph thuc trc tip vo mc  an ton ca cc gi bn th ba m bn s dng trong ng dng ca mnh. Do , iu quan trng l phi cp nht cc gi ca bn. Cn lu  rng <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities">S dng cc thnh phn c l hng</a>  bit vn nm trong Top 10 ca OWASP. Bn c th s dng OWASP <a href="https://jeremylong.github.io/DependencyCheck/analyzers/nodejs.html">OWASP Dependency-Check</a>  xem liu c bt k gi no c s dng trong d n c l hng  bit hay khng. Ngoi ra, bn c th s dng <a href="https://github.com/retirejs/retire.js/">Retire.js</a>  kim tra cc th vin JavaScript c l hng  bit.</p>
<p>Bt u vi phin bn 6, <code>npm</code>  gii thiu <code>audit</code>, s cnh bo v cc gi d b tn cng:</p>
<div class="highlight"><pre><span></span><code>npm<span class="w"> </span>audit
</code></pre></div>
<p><code>npm</code> cng gii thiu mt cch n gin  nng cp cc gi b nh hng:</p>
<div class="highlight"><pre><span></span><code>npm<span class="w"> </span>audit<span class="w"> </span>fix
</code></pre></div>
<p>C mt s cng c khc m bn c th s dng  kim tra cc ph thuc ca mnh. Mt danh sch ton din hn c th c tm thy trong <a href="https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html#tools">Vulnerable Dependency Management CS</a>.</p>
<h4 id="do-not-use-dangerous-functions">Do not use dangerous functions<a class="headerlink" href="#do-not-use-dangerous-functions" title="Permanent link">&para;</a></h4>
<p>C mt s hm JavaScript nguy him v ch nn c s dng khi cn thit hoc khng th trnh khi. V d u tin l hm <code>eval()</code>. Hm ny ly mt i s chui v thc thi n nh bt k m ngun JavaScript no khc. Kt hp vi u vo ca ngi dng, hnh vi ny vn dn n l hng thc thi m t xa. Tng t, cc cuc gi n <code>child_process.exec</code> cng rt nguy him. Hm ny hot ng nh mt trnh thng dch bash v gi cc i s ca n n /bin/sh. Bng cch tim u vo cho chc nng ny, k tn cng c th thc hin cc lnh ty  trn my ch.</p>
<p>Ngoi cc chc nng ny, mt s m-un yu cu s chm sc c bit khi c s dng. V d, m-un <code>fs</code> x l cc hot ng ca h thng tp. Tuy nhin, nu u vo ngi dng c kh trng khng ng cch c a vo m-un ny, ng dng ca bn c th tr nn d b tn thng bi cc l hng bao gm tp v truyn th mc. Tng t, m-un <code>vm</code> cung cp API  bin dch v chy m trong ng cnh My o V8. V n c th thc hin cc hnh ng nguy him t nhin, n nn c s dng trong hp ct.</p>
<p>S khng cng bng khi ni rng cc chc nng v m-un ny khng nn c s dng, tuy nhin, chng nn c s dng cn thn, c bit l khi chng s dng vi u vo ca ngi dng. Ngoi ra, <a href="https://github.com/wisec/domxsswiki/wiki/Direct-Execution-Sinks">c mt s chc nng khc</a> c th khin ng dng ca bn d b tn cng.</p>
<h4 id="stay-away-from-evil-regexes">Stay away from evil regexes<a class="headerlink" href="#stay-away-from-evil-regexes" title="Permanent link">&para;</a></h4>
<p>T chi dch v biu thc chnh quy (ReDoS) l mt cuc tn cng t chi dch v, khai thc thc t l hu ht cc trin khai Biu thc chnh quy c th t n cc tnh hung cc oan khin chng hot ng rt chm (lin quan theo cp s nhn n kch thc u vo). K tn cng sau  c th gy ra mt chng trnh s dng Biu thc chnh quy  nhp cc tnh hung cc oan ny v sau  b treo trong mt thi gian rt di.</p>
<p><a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">T chi dch v biu thc chnh quy (ReDoS)</a> l mt loi tn cng T chi Dch v s dng cc biu thc chnh quy. Mt s trin khai Biu thc Chnh quy (Regex) c th gy ra cc tnh hung cc oan khin ng dng chy rt chm. K tn cng c th khai thc cc trin khai regex ny  a ng dng vo nhng tnh hung cc oan v khin n b treo trong thi gian di. Nhng regex nh vy c gi l 'evil' (c ) nu ng dng c th b kt bi u vo c to tinh vi. Thng thng, nhng regex ny b khai thc bng cch nhm vi s lp li v s thay th c s chng cho. V d, biu thc chnh quy sau y <code>^(([a-z])+.)+A-Z+$</code> c th c s dng  ch nh tn lp Java. Tuy nhin, mt chui rt di (aaaa...aaaaAaaaaa...aaaa) cng c th khp vi biu thc chnh quy ny. C mt s cng c kim tra xem liu mt regex c tim nng gy ra tn cng t chi dch v hay khng. Mt v d l <a href="https://github.com/davisjam/vuln-regex-detector">vuln-regex-detector</a>.</p>
<h4 id="run-security-linters">Run security linters<a class="headerlink" href="#run-security-linters" title="Permanent link">&para;</a></h4>
<p>Khi pht trin m, vic ghi nh tt c cc mo bo mt c th rt kh khn. Hn na, m bo tt c thnh vin trong nhm tun th cc quy tc ny gn nh l khng th. y l l do ti sao c cc cng c Kim tra Bo mt Tnh (SAST). Nhng cng c ny khng thc thi m ca bn, m n gin l tm kim cc mu c th cha ri ro bo mt. V JavaScript l ngn ng ng v kiu d liu khng cht ch, cc cng c linting thc s rt quan trng trong vng i pht trin phn mm. Cc quy tc linting cn c xem xt nh k v cc pht hin cn c kim tra k lng. Mt li th khc ca cc cng c ny l tnh nng cho php bn thm cc quy tc ty chnh cho cc mu m bn cho l nguy him. <a href="http://jshint.com/">JSHint</a> v <a href="http://jshint.com/">JSHint</a> l nhng cng c SAST c s dng ph bin  linting JavaScript.</p>
<h4 id="use-strict-mode">Use strict mode<a class="headerlink" href="#use-strict-mode" title="Permanent link">&para;</a></h4>
<p>JavaScript c mt s tnh nng c khng an ton v nguy him m khng nn s dng.  loi b nhng tnh nng ny, ES5  gii thiu ch  nghim ngt (strict mode) dnh cho cc nh pht trin. Vi ch  ny, cc li trc y b b qua s c nm ra. N cng gip cc engine JavaScript thc hin ti u ha. Vi ch  nghim ngt, nhng c php xu m trc y c chp nhn s gy ra li thc s. V nhng ci tin ny, bn nn lun s dng ch  nghim ngt trong ng dng ca mnh.  bt ch  nghim ngt, bn ch cn vit <code>"use strict";</code>  u on m ca mnh.</p>
<p>on m sau y s to ra li ReferenceError: Can't find variable: y trn bng iu khin, li ny s khng hin th nu khng s dng ch  nghim ngt:</p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">func</span><span class="p">();</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.14</span><span class="p">;</span><span class="w">   </span><span class="c1">// This will cause an error (y is not defined)</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="adhere-to-general-application-security-principles">Adhere to general application security principles<a class="headerlink" href="#adhere-to-general-application-security-principles" title="Permanent link">&para;</a></h4>
<p>Danh sch ny ch yu tp trung vo cc vn  thng gp trong cc ng dng Node.js, cng vi cc khuyn ngh v v d. Ngoi ra, cn c cc <a href="https://wiki.owasp.org/index.php/Security_by_Design_Principles">nguyn tc bo mt theo thit k</a> p dng cho cc ng dng web bt k cng ngh no c s dng trn my ch ng dng. Bn cng nn ghi nh nhng nguyn tc ny khi pht trin ng dng ca mnh. Bn c th tham kho <a href="https://cheatsheetseries.owasp.org/">OWASP Cheat Sheet Series</a>  tm hiu thm v cc l hng bo mt ca ng dng web v cc k thut gim thiu ri ro.</p>
<h2 id="additional-resources-about-nodejs-security">Additional resources about Node.js security<a class="headerlink" href="#additional-resources-about-nodejs-security" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/lirantal/awesome-nodejs-security">Awesome Node.js Security resources</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright <script>document.write(new Date().getFullYear())</script> - Cheat Sheets Series Team - This work is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>