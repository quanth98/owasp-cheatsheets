        ---
        redirect_from: "/cheatsheets/Nodejs_security_cheat_sheet.html"
        ---
        
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Website with the collection of all the cheat sheets of the project.">
      
      
      
        <link rel="canonical" href="https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html">
      
      
        <link rel="prev" href="NodeJS_Docker_Cheat_Sheet.html">
      
      
        <link rel="next" href="OAuth2_Cheat_Sheet.html">
      
      
      <link rel="icon" href="../assets/WebSite_Favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.3.2">
    
    
      
        <title>Nodejs Security - OWASP Cheat Sheet Series</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.30068a00.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-header__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Cheat Sheet Series
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Nodejs Security Cheat Sheet
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="OWASP Cheat Sheet Series" class="md-nav__button md-logo" aria-label="OWASP Cheat Sheet Series" data-md-component="logo">
      
  <img src="../assets/OWASP_Logo.svg" alt="logo">

    </a>
    OWASP Cheat Sheet Series
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/CheatSheetSeries" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/CheatSheetSeries
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../Glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexMASVS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexMASVS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexProactiveControls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexProactiveControls
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../IndexTopTen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IndexTopTen
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="AJAX_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AJAX Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Abuse_Case_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abuse Case Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Access_Control_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Attack_Surface_Analysis_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack Surface Analysis Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Authorization_Testing_Automation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization Testing Automation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Bean_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bean Validation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="C-Based_Toolchain_Hardening_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C Based Toolchain Hardening Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="CI_CD_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI CD Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Choosing_and_Using_Security_Questions_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing and Using Security Questions Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Clickjacking_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clickjacking Defense Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Content_Security_Policy_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Security Policy Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Credential_Stuffing_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Stuffing Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Request Forgery Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Cryptographic_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptographic Storage Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="DOM_Clobbering_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM Clobbering Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="DOM_based_XSS_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Database_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Denial_of_Service_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denial of Service Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Deserialization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deserialization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Django_REST_Framework_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django REST Framework Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Django_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Django Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Docker_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="DotNet_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DotNet Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Error_Handling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="File_Upload_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Upload Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Forgot_Password_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forgot Password Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="GraphQL_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="HTML5_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML5 Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Headers_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Headers Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="HTTP_Strict_Transport_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Strict Transport Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Infrastructure_as_Code_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Injection_Prevention_in_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injection Prevention in Java Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Input_Validation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Validation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="JAAS_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAAS Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="JSON_Web_Token_for_Java_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Web Token for Java Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Java_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Key_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Kubernetes_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="LDAP_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Injection Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Laravel_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laravel Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Logging_Vocabulary_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Vocabulary Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Mass_Assignment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass Assignment Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Microservices_based_Security_Arch_Doc_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microservices based Security Arch Doc Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Mobile_Application_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mobile Application Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Multifactor_Authentication_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="NPM_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPM Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Network_Segmentation_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Segmentation Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="NodeJS_Docker_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Docker Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Nodejs Security Cheat Sheet
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Nodejs_Security_Cheat_Sheet.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Nodejs Security Cheat Sheet
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    Context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    Recommendations
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-security" class="md-nav__link">
    Application Security
  </a>
  
    <nav class="md-nav" aria-label="Application Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-flat-promise-chains" class="md-nav__link">
    Use flat Promise chains
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-request-size-limits" class="md-nav__link">
    Set request size limits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-block-the-event-loop" class="md-nav__link">
    Do not block the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-input-validation" class="md-nav__link">
    Perform input validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-output-escaping" class="md-nav__link">
    Perform output escaping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-application-activity-logging" class="md-nav__link">
    Perform application activity logging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-the-event-loop" class="md-nav__link">
    Monitor the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take-precautions-against-brute-forcing" class="md-nav__link">
    Take precautions against brute-forcing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-anti-csrf-tokens" class="md-nav__link">
    Use Anti-CSRF tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-unnecessary-routes" class="md-nav__link">
    Remove unnecessary routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prevent-http-parameter-pollution" class="md-nav__link">
    Prevent HTTP Parameter Pollution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-return-what-is-necessary" class="md-nav__link">
    Only return what is necessary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-object-property-descriptors" class="md-nav__link">
    Use object property descriptors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-access-control-lists" class="md-nav__link">
    Use access control lists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-exception-handling" class="md-nav__link">
    Error &amp; Exception Handling
  </a>
  
    <nav class="md-nav" aria-label="Error & Exception Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#handle-uncaughtexception" class="md-nav__link">
    Handle uncaughtException
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listen-to-errors-when-using-eventemitter" class="md-nav__link">
    Listen to errors when using EventEmitter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-errors-in-asynchronous-calls" class="md-nav__link">
    Handle errors in asynchronous calls
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-security" class="md-nav__link">
    Server Security
  </a>
  
    <nav class="md-nav" aria-label="Server Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-cookie-flags-appropriately" class="md-nav__link">
    Set cookie flags appropriately
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-appropriate-security-headers" class="md-nav__link">
    Use appropriate security headers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#platform-security" class="md-nav__link">
    Platform Security
  </a>
  
    <nav class="md-nav" aria-label="Platform Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-your-packages-up-to-date" class="md-nav__link">
    Keep your packages up-to-date
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-use-dangerous-functions" class="md-nav__link">
    Do not use dangerous functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stay-away-from-evil-regexes" class="md-nav__link">
    Stay away from evil regexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-security-linters" class="md-nav__link">
    Run security linters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-strict-mode" class="md-nav__link">
    Use strict mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adhere-to-general-application-security-principles" class="md-nav__link">
    Adhere to general application security principles
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources-about-nodejs-security" class="md-nav__link">
    Additional resources about Node.js security
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="OAuth2_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2 Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="OS_Command_Injection_Defense_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Command Injection Defense Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="PHP_Configuration_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP Configuration Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Password_Storage_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Storage Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Pinning_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinning Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Prototype_Pollution_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype Pollution Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Query_Parameterization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Parameterization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="REST_Assessment_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Assessment Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="REST_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Ruby_on_Rails_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby on Rails Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="SAML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="SQL_Injection_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Secrets_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Cloud_Architecture_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Cloud Architecture Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Secure_Product_Design_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Product Design Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Securing_Cascading_Style_Sheets_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Securing Cascading Style Sheets Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Request Forgery Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Session_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Software_Supply_Chain_Security.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Supply Chain Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Symfony_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symfony Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="TLS_Cipher_String_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Cipher String Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Third_Party_Javascript_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third Party Javascript Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Threat_Modeling_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threat Modeling Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Transaction_Authorization_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transaction Authorization Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Protection Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transport Layer Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unvalidated Redirects and Forwards Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="User_Privacy_Protection_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Privacy Protection Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Virtual_Patching_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Patching Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerability_Disclosure_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Disclosure Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Vulnerable_Dependency_Management_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Dependency Management Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Web_Service_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Service Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XML_External_Entity_Prevention_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity Prevention Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XML_Security_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Security Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XSS_Filter_Evasion_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS Filter Evasion Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="XS_Leaks_Cheat_Sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XS Leaks Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    Context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    Recommendations
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-security" class="md-nav__link">
    Application Security
  </a>
  
    <nav class="md-nav" aria-label="Application Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-flat-promise-chains" class="md-nav__link">
    Use flat Promise chains
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-request-size-limits" class="md-nav__link">
    Set request size limits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-block-the-event-loop" class="md-nav__link">
    Do not block the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-input-validation" class="md-nav__link">
    Perform input validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-output-escaping" class="md-nav__link">
    Perform output escaping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-application-activity-logging" class="md-nav__link">
    Perform application activity logging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-the-event-loop" class="md-nav__link">
    Monitor the event loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take-precautions-against-brute-forcing" class="md-nav__link">
    Take precautions against brute-forcing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-anti-csrf-tokens" class="md-nav__link">
    Use Anti-CSRF tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-unnecessary-routes" class="md-nav__link">
    Remove unnecessary routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prevent-http-parameter-pollution" class="md-nav__link">
    Prevent HTTP Parameter Pollution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-return-what-is-necessary" class="md-nav__link">
    Only return what is necessary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-object-property-descriptors" class="md-nav__link">
    Use object property descriptors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-access-control-lists" class="md-nav__link">
    Use access control lists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-exception-handling" class="md-nav__link">
    Error &amp; Exception Handling
  </a>
  
    <nav class="md-nav" aria-label="Error & Exception Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#handle-uncaughtexception" class="md-nav__link">
    Handle uncaughtException
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listen-to-errors-when-using-eventemitter" class="md-nav__link">
    Listen to errors when using EventEmitter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-errors-in-asynchronous-calls" class="md-nav__link">
    Handle errors in asynchronous calls
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-security" class="md-nav__link">
    Server Security
  </a>
  
    <nav class="md-nav" aria-label="Server Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-cookie-flags-appropriately" class="md-nav__link">
    Set cookie flags appropriately
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-appropriate-security-headers" class="md-nav__link">
    Use appropriate security headers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#platform-security" class="md-nav__link">
    Platform Security
  </a>
  
    <nav class="md-nav" aria-label="Platform Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-your-packages-up-to-date" class="md-nav__link">
    Keep your packages up-to-date
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#do-not-use-dangerous-functions" class="md-nav__link">
    Do not use dangerous functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stay-away-from-evil-regexes" class="md-nav__link">
    Stay away from evil regexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-security-linters" class="md-nav__link">
    Run security linters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-strict-mode" class="md-nav__link">
    Use strict mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adhere-to-general-application-security-principles" class="md-nav__link">
    Adhere to general application security principles
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources-about-nodejs-security" class="md-nav__link">
    Additional resources about Node.js security
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Nodejs Security Cheat Sheet</h1>

<div class="highlight"><pre><span></span><code>        Title: Nodejs Security
        # NodeJS Security Cheat Sheet
</code></pre></div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<!-- This cheat sheet lists actions developers can take to develop secure Node.js applications. Each item has a brief explanation and solution that is specific to the Node.js environment. -->

<p>Cheat sheet này sẽ liệt kê các action mà developer có thể làm cho nodejs app bảo mật hơn. Mỗi item có một ví dụ ngắn gọn giải thích và giải pháp được chỉ định trong môi trường nodejs</p>
<h2 id="context">Context<a class="headerlink" href="#context" title="Permanent link">&para;</a></h2>
<!-- Node.js applications are increasing in number and they are no different from other frameworks and programming languages. Node.js applications are prone to all kinds of web application vulnerabilities. -->

<p>Các ứng dụng Node.js ngày càng tăng về số lượng và chúng không khác gì các framework và ngôn ngữ lập trình khác. Các ứng dụng Node.js dễ gặp phải tất cả các loại lỗ hổng ứng dụng web.</p>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">&para;</a></h2>
<!-- This cheat sheet aims to provide a list of best practices to follow during development of Node.js applications. -->

<p>Tài liệu này nhằm cung cấp danh sách các thực tiễn tốt nhất để tuân theo trong quá trình phát triển ứng dụng Node.js.</p>
<h2 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permanent link">&para;</a></h2>
<!-- There are several recommendations to enhance security of your Node.js applications. These are categorized as: -->

<p>Có một số khuyến nghị để nâng cao bảo mật cho ứng dụng Node.js của bạn. Chúng được phân loại như sau:</p>
<ul>
<li><strong>Application Security</strong></li>
<li><strong>Error &amp; Exception Handling</strong></li>
<li><strong>Server Security</strong></li>
<li><strong>Platform Security</strong></li>
</ul>
<h3 id="application-security">Application Security<a class="headerlink" href="#application-security" title="Permanent link">&para;</a></h3>
<h4 id="use-flat-promise-chains">Use flat Promise chains<a class="headerlink" href="#use-flat-promise-chains" title="Permanent link">&para;</a></h4>
<!-- Asynchronous callback functions are one of the strongest features of Node.js. However, increasing layers of nesting within callback functions can become a problem. Any multistage process can become nested 10 or more levels deep. This problem is referred to as a "Pyramid of Doom" or "Callback Hell". In such code, the errors and results get lost within the callback. Promises are a good way to write asynchronous code without getting into nested pyramids. Promises provide top-down execution while being asynchronous by delivering errors and results to next `.then` function. -->

<p>Các hàm callback bất đồng bộ là một trong những tính năng mạnh mẽ nhất của Node.js. Tuy nhiên, việc tăng các lớp lồng nhau trong các hàm callback có thể trở thành một vấn đề. Bất kỳ quy trình đa giai đoạn nào cũng có thể bị lồng nhau sâu 10 cấp hoặc hơn. Vấn đề này được gọi là "Pyramid of Doom" (Kim tự tháp của sự diệt vong) hoặc "callback hell"(Địa ngục callback). Trong mã như vậy, lỗi và kết quả bị mất trong callback. Promises là một cách tốt để viết mã bất đồng bộ mà không bị lồng vào các kim tự tháp. Promises cung cấp thực thi từ trên xuống trong khi vẫn bất đồng bộ bằng cách chuyển lỗi và kết quả cho hàm .then tiếp theo.</p>
<!-- Another advantage of Promises is the way Promises handle errors. If an error occurs in a Promise class, it skips over the `.then` functions and invokes the first `.catch` function it finds. This way Promises provide a higher assurance of capturing and handling errors. As a principle, you can make all your asynchronous code (apart from emitters) return promises. It should be noted that Promise calls can also become a pyramid. In order to completely stay away from "Callback Hell", flat Promise chains should be used. If the module you are using does not support Promises, you can convert base object to a Promise by using `Promise.promisifyAll()` function. -->

<p>Một lợi thế khác của Promises là cách Promises xử lý lỗi. Nếu lỗi xảy ra trong một lớp Promise, nó sẽ bỏ qua các hàm .then và gọi hàm .catch đầu tiên mà nó tìm thấy. Bằng cách này, Promises cung cấp mức độ đảm bảo cao hơn về việc nắm bắt và xử lý lỗi. Theo nguyên tắc, bạn có thể khiến tất cả mã bất đồng bộ của mình (ngoại trừ các bộ phát) trả về các lời hứa. Cần lưu ý rằng các cuộc gọi Promise cũng có thể trở thành một kim tự tháp. Để tránh hoàn toàn "Callback Hell", nên sử dụng các chuỗi Promise phẳng. Nếu mô-đun bạn đang sử dụng không hỗ trợ Promises, bạn có thể chuyển đổi đối tượng cơ sở thành một Promise bằng cách sử dụng hàm Promise.promisifyAll().</p>
<p>The following code snippet is an example of "Callback Hell":</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then calls the callback</span>
<span class="p">}</span>

<span class="nx">func1</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result1</span><span class="p">){</span>
<span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">      </span><span class="c1">// error operations</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">//some operations</span>
<span class="w">      </span><span class="nx">func2</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result2</span><span class="p">){</span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">            </span><span class="c1">//error operations</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="k">else</span><span class="p">{</span>
<span class="w">            </span><span class="c1">//some operations</span>
<span class="w">            </span><span class="nx">func3</span><span class="p">(</span><span class="s2">&quot;input3&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result3</span><span class="p">){</span>
<span class="w">               </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">                  </span><span class="c1">//error operations</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span><span class="k">else</span><span class="p">{</span>
<span class="w">                  </span><span class="c1">// some operations</span>
<span class="w">                  </span><span class="nx">func4</span><span class="p">(</span><span class="s2">&quot;input 4&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result4</span><span class="p">){</span>
<span class="w">                     </span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">                        </span><span class="c1">// error operations</span>
<span class="w">                     </span><span class="p">}</span>
<span class="w">                     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// some operations</span>
<span class="w">                     </span><span class="p">}</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>The above code can be securely written as follows using a flat Promise chain:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>

<span class="nx">func1</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">)</span>
<span class="w">   </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="p">})</span>
<span class="w">   </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="s2">&quot;input3&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="p">})</span>
<span class="w">   </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="s2">&quot;input4&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="p">})</span>
<span class="w">   </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// error operations</span>
<span class="w">   </span><span class="p">});</span>
</code></pre></div>
<p>And using async/await:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>
<span class="kd">function</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// operations that takes a bit of time and then resolves the promise</span>
<span class="p">}</span>

<span class="p">(</span><span class="k">async</span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func1</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func2</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func3</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">res4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">func4</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// error operations</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})();</span>
</code></pre></div>
<h4 id="set-request-size-limits">Set request size limits<a class="headerlink" href="#set-request-size-limits" title="Permanent link">&para;</a></h4>
<p>Việc lưu vào bộ nhớ đệm và phân tích cú pháp các nội dung yêu cầu có thể là một nhiệm vụ tốn nhiều tài nguyên. Nếu không có giới hạn về kích thước yêu cầu, kẻ tấn công có thể gửi yêu cầu có nội dung yêu cầu lớn có thể làm cạn kiệt bộ nhớ máy chủ và/hoặc lấp đầy dung lượng ổ đĩa. Bạn có thể giới hạn kích thước nội dung yêu cầu cho tất cả các yêu cầu bằng cách sử <a href="https://www.npmjs.com/package/raw-body">raw-body</a>.</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">contentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">getRawBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;raw-body&#39;</span><span class="p">)</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">()</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DELETE&#39;</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">next</span><span class="p">()</span>
<span class="w">    </span><span class="k">return</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">getRawBody</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;content-length&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1kb&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="nx">contentType</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">).</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">charset</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">next</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="nx">req</span><span class="p">.</span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">string</span>
<span class="w">    </span><span class="nx">next</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</code></pre></div>
<p>Tuy nhiên, việc cố định giới hạn kích thước yêu cầu cho tất cả các yêu cầu có thể không phải là hành vi chính xác, vì một số yêu cầu có thể có tải trọng lớn trong thân yêu cầu, chẳng hạn như khi tải lên tệp. Ngoài ra, đầu vào với kiểu JSON nguy hiểm hơn đầu vào đa phần, vì phân tích cú pháp JSON là một hoạt động chặn. Do đó, bạn nên đặt giới hạn kích thước yêu cầu cho các loại nội dung khác nhau. Bạn có thể thực hiện điều này rất dễ dàng với middleware express như sau:</p>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span><span class="w"> </span><span class="nx">extended</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1kb&quot;</span><span class="w"> </span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1kb&quot;</span><span class="w"> </span><span class="p">}));</span>
</code></pre></div>
<p>Cần lưu ý rằng kẻ tấn công có thể thay đổi Content-Type header của request và bỏ qua giới hạn kích thước request. Do đó, trước khi xử lý request, dữ liệu chứa trong request phải được xác thực dựa trên loại nội dung được nêu trong request headers. Nếu việc xác thực loại nội dung cho từng request ảnh hưởng nghiêm trọng đến hiệu suất, bạn chỉ có thể xác thực các loại nội dung cụ thể hoặc yêu cầu lớn hơn kích thước xác định trước.</p>
<h4 id="do-not-block-the-event-loop">Do not block the event loop<a class="headerlink" href="#do-not-block-the-event-loop" title="Permanent link">&para;</a></h4>
<p>Node.js rất khác so với các ứng dụng sử dụng luồng. Node.js có kiến trúc hướng sự kiện đơn luồng. Bằng kiến trúc này, thông lượng trở nên cao và mô hình lập trình trở nên đơn giản hơn. Node.js được triển khai xung quanh non-blocking I/O event loop. Với event loop, bạn không phải chờ đợi I/O hoặc chuyển đổi ngữ cảnh. Vòng lặp sự kiện tìm kiếm các sự kiện và gửi chúng đến các hàm xử lý. Do đó, khi các hoạt động JavaScript chuyên sâu của CPU được thực thi, vòng lặp sự kiện sẽ đợi chúng kết thúc. Đây là lý do tại sao các hoạt động như vậy được gọi là "blocking". Để khắc phục sự cố này, Node.js cho phép gán callback cho các sự kiện bị chặn IO. Bằng cách này, ứng dụng chính không bị chặn và callback chạy không đồng bộ. Do đó, theo nguyên tắc chung, tất cả các hoạt động chặn phải được thực hiện không đồng bộ để vòng lặp sự kiện không bị chặn.</p>
<p>Ngay cả khi bạn thực hiện các thao tác chặn không đồng bộ, ứng dụng của bạn vẫn có thể không phục vụ như mong đợi. Điều này xảy ra nếu có một mã bên ngoài callback dựa vào mã trong callback để chạy trước. Ví dụ: hãy xem xét mã sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// perform actions on file content</span>
<span class="p">});</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">unlinkSync</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Trong ví dụ trên, hàm unlinkSync có thể chạy trước khi callback, hàm này sẽ xóa tệp trước khi các hành động mong muốn trên nội dung tệp được thực hiện. Các điều kiện đua như vậy cũng có thể ảnh hưởng đến tính bảo mật của ứng dụng của bạn. Một ví dụ sẽ là một kịch bản trong đó xác thực được thực hiện trong một cuộc gọi lại và các hành động được xác thực được chạy đồng bộ. Để loại bỏ các điều kiện đua như vậy, bạn có thể viết tất cả các hoạt động dựa vào nhau trong một chức năng không chặn duy nhất. Bằng cách đó, bạn có thể đảm bảo rằng tất cả các hoạt động được thực hiện theo đúng thứ tự. Ví dụ, ví dụ về code trên có thể được viết theo cách không chặn như sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// perform actions on file content</span>
<span class="w">  </span><span class="nx">fs</span><span class="p">.</span><span class="nx">unlink</span><span class="p">(</span><span class="s1">&#39;/file.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="nx">err</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<p>Trong đoạn mã trên, lệnh gọi để hủy liên kết tệp và các thao tác tệp khác nằm trong cùng một cuộc gọi lại. Điều này cung cấp thứ tự hoạt động chính xác.</p>
<h4 id="perform-input-validation">Perform input validation<a class="headerlink" href="#perform-input-validation" title="Permanent link">&para;</a></h4>
<p>Xác thực đầu vào là một phần quan trọng của bảo mật ứng dụng. Lỗi xác thực đầu vào có thể dẫn đến nhiều loại tấn công ứng dụng. Chúng bao gồm SQL Injection, Cross-Site Scripting, Command Injection, Local / Remote File Inclusion, Denial of Service, Directory Traversal, LDAP Injection và nhiều cuộc tấn công injection khác. Để tránh những cuộc tấn công này, đầu vào cho ứng dụng của bạn nên được vệ sinh trước. Kỹ thuật xác thực đầu vào tốt nhất là sử dụng danh sách các đầu vào được chấp nhận. Tuy nhiên, nếu điều này là không thể, trước tiên cần kiểm tra đầu vào so với sơ đồ đầu vào dự kiến và các đầu vào nguy hiểm nên được thoát. Để dễ dàng xác thực đầu vào trong các ứng dụng Node.js, có một số mô-đun như <a href="https://www.npmjs.com/package/validator">validator</a> and <a href="https://www.npmjs.com/package/express-mongo-sanitize">express-mongo-sanitize</a>.
Để biết thông tin chi tiết về xác thực đầu vào, vui lòng tham khảo <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">Input Validation Cheat Sheet</a>.</p>
<p>JavaScript là một ngôn ngữ động và tùy thuộc vào cách framework phân tích cú pháp URL, dữ liệu được nhìn thấy bởi mã ứng dụng có thể có nhiều dạng. Dưới đây là một số ví dụ sau khi phân tích cú pháp chuỗi truy vấn trong express.js:</p>
<table>
<thead>
<tr>
<th>URL</th>
<th>Content of request.query.foo in code</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>?foo=bar</code></td>
<td><code>'bar'</code> (string)</td>
</tr>
<tr>
<td><code>?foo=bar&amp;foo=baz</code></td>
<td><code>['bar', 'baz']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[]=bar</code></td>
<td><code>['bar']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[]=bar&amp;foo[]=baz</code></td>
<td><code>['bar', 'baz']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[bar]=baz</code></td>
<td><code>{ bar : 'baz' }</code> (object with a key)</td>
</tr>
<tr>
<td><code>?foo[]=bar</code></td>
<td><code>['bar']</code> (array of string)</td>
</tr>
<tr>
<td><code>?foo[]baz=bar</code></td>
<td><code>['bar']</code> (array of string - postfix is lost)</td>
</tr>
<tr>
<td><code>?foo[][baz]=bar</code></td>
<td><code>[ { baz: 'bar' } ]</code> (array of object)</td>
</tr>
<tr>
<td><code>?foo[bar][baz]=bar</code></td>
<td><code>{ foo: { bar: { baz: 'bar' } } }</code> (object tree)</td>
</tr>
<tr>
<td><code>?foo[10]=bar&amp;foo[9]=baz</code></td>
<td><code>[ 'baz', 'bar' ]</code> (array of string - notice order)</td>
</tr>
<tr>
<td><code>?foo[toString]=bar</code></td>
<td><code>{}</code> (object where calling <code>toString()</code> will fail)</td>
</tr>
</tbody>
</table>
<h4 id="perform-output-escaping">Perform output escaping<a class="headerlink" href="#perform-output-escaping" title="Permanent link">&para;</a></h4>
<p>Ngoài việc xác thực đầu vào, bạn nên thoát tất cả nội dung HTML và JavaScript được hiển thị cho người dùng thông qua ứng dụng để ngăn chặn các cuộc tấn công cross-site scripting (XSS). Bạn có thể sử dụng <a href="https://github.com/component/escape-html">escape-html</a> or <a href="https://github.com/ESAPI/node-esapi">node-esapi</a> libraries để thực hiện output escaping.</p>
<h4 id="perform-application-activity-logging">Perform application activity logging<a class="headerlink" href="#perform-application-activity-logging" title="Permanent link">&para;</a></h4>
<p>Ghi nhật ký hoạt động ứng dụng là một thực hành tốt được khuyến khích. Nó giúp dễ dàng gỡ lỗi bất kỳ lỗi nào gặp phải trong thời gian chạy ứng dụng. Nó cũng hữu ích cho các mối quan tâm về bảo mật, vì nó có thể được sử dụng trong quá trình ứng phó sự cố. Ngoài ra, các nhật ký này có thể được sử dụng để cung cấp cho Hệ thống Phát hiện / Ngăn chặn Xâm nhập (IDS / IPS). Trong Node.js, có các mô-đun như <a href="https://www.npmjs.com/package/winston">Winston</a>, <a href="https://www.npmjs.com/package/bunyan">Bunyan</a>, or <a href="https://www.npmjs.com/package/pino">Pino</a> để thực hiện ghi log ứng dụng. Những module này cho phép streaming and querying logs, and chúng cung cấp một cách để xử lý các ngoại lệ không bị bắt.</p>
<p>Với đoạn mã sau, bạn có thể ghi lại các hoạt động của ứng dụng trong cả bảng điều khiển và tệp nhật ký mong muốn:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="p">(</span><span class="nx">Winston</span><span class="p">.</span><span class="nx">Logger</span><span class="p">)</span><span class="w"> </span><span class="p">({</span>
<span class="w">    </span><span class="nx">transports</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="ow">new</span><span class="w"> </span><span class="p">(</span><span class="nx">winston</span><span class="p">.</span><span class="nx">transports</span><span class="p">.</span><span class="nx">Console</span><span class="p">)(),</span>
<span class="w">        </span><span class="ow">new</span><span class="w"> </span><span class="p">(</span><span class="nx">winston</span><span class="p">.</span><span class="nx">transports</span><span class="p">.</span><span class="nx">File</span><span class="p">)({</span><span class="w"> </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application.log&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;verbose&#39;</span>
<span class="p">});</span>
</code></pre></div>
<p>Bạn có thể cung cấp các phương tiện truyền tải khác nhau để bạn có thể lưu lỗi vào tệp nhật ký riêng biệt và nhật ký ứng dụng chung vào tệp nhật ký khác. Thông tin bổ sung về ghi nhật ký bảo mật có thể được tìm thấy trong <a href="https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html">Logging Cheat Sheet</a>.</p>
<h4 id="monitor-the-event-loop">Monitor the event loop<a class="headerlink" href="#monitor-the-event-loop" title="Permanent link">&para;</a></h4>
<p>Khi máy chủ ứng dụng của bạn có lưu lượng mạng lớn, nó có thể không phục vụ được người dùng. Đây thực chất là một loại <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Denial of Service (DoS)</a> attack. Mô-đun <a href="https://www.npmjs.com/package/toobusy-js">toobusy-js</a> cho phép bạn theo dõi vòng lặp sự kiện. Nó theo dõi thời gian phản hồi và khi vượt quá một ngưỡng nhất định, mô-đun này có thể cho biết máy chủ của bạn quá bận. Trong trường hợp đó, bạn có thể ngừng xử lý các yêu cầu đến và gửi cho chúng thông báo <code>503 Server Too Busy</code> để ứng dụng của bạn luôn phản hồi. <a href="https://www.npmjs.com/package/toobusy-js">toobusy-js</a> module hiển thị ở đây</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">toobusy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;toobusy-js&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">toobusy</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// log if you see necessary</span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">503</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;Server Too Busy&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">next</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="take-precautions-against-brute-forcing">Take precautions against brute-forcing<a class="headerlink" href="#take-precautions-against-brute-forcing" title="Permanent link">&para;</a></h4>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#protect-against-automated-attacks">Brute-forcing</a> là một mối đe dọa phổ biến đối với tất cả các ứng dụng web. Những kẻ tấn công có thể sử dụng brute-force như một cuộc tấn công đoán mật khẩu để lấy mật khẩu tài khoản. Do đó, các nhà phát triển ứng dụng nên đề phòng các cuộc tấn công brute-force, đặc biệt là trong các trang đăng nhập. Node.js có một số mô-đun có sẵn cho mục đích này <a href="https://libraries.io/npm/express-bouncer">Express-bouncer</a>, <a href="https://libraries.io/npm/express-brute">express-brute</a> and <a href="https://libraries.io/npm/rate-limiter">rate-limiter</a> chỉ là một số ví dụ. Dựa trên nhu cầu và yêu cầu của bạn, bạn nên chọn một hoặc nhiều mô-đun này và sử dụng cho phù hợp. Mô-đun <a href="https://libraries.io/npm/express-bouncer">Express-bouncer</a> và <a href="https://libraries.io/npm/express-brute">express-brute</a> hoạt động tương tự nhau. Chúng làm tăng độ trễ cho mỗi yêu cầu không thành công và có thể được sắp xếp cho một tuyến đường cụ thể. Các mô-đun này có thể được sử dụng như sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">bouncer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-bouncer&#39;</span><span class="p">);</span>
<span class="nx">bouncer</span><span class="p">.</span><span class="nx">whitelist</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// allow an IP address</span>
<span class="c1">// give a custom error message</span>
<span class="nx">bouncer</span><span class="p">.</span><span class="nx">blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">,</span><span class="w"> </span><span class="nx">remaining</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">429</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;Too many requests have been made. Please wait &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">remaining</span><span class="o">/</span><span class="mf">1000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; seconds.&quot;</span><span class="p">);</span>
<span class="p">};</span>
<span class="c1">// route to protect</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&quot;/login&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">bouncer</span><span class="p">.</span><span class="nx">block</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">LoginFailed</span><span class="p">){</span><span class="w">  </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">bouncer</span><span class="p">.</span><span class="nx">reset</span><span class="p">(</span><span class="w"> </span><span class="nx">req</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">ExpressBrute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-brute&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ExpressBrute</span><span class="p">.</span><span class="nx">MemoryStore</span><span class="p">();</span><span class="w"> </span><span class="c1">// stores state locally, don&#39;t use this in production</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">bruteforce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ExpressBrute</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/auth&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">bruteforce</span><span class="p">.</span><span class="nx">prevent</span><span class="p">,</span><span class="w"> </span><span class="c1">// error 429 if we hit this route too often</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Success!&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">);</span>
</code></pre></div>
<p>Ngoài <a href="https://libraries.io/npm/express-bouncer">express-bouncer</a> và <a href="https://libraries.io/npm/express-brute">express-brute</a>, mô-đun <a href="https://libraries.io/npm/rate-limiter">rate-limiter</a> cũng có thể giúp ngăn chặn các cuộc tấn công brute-force. Nó cho phép chỉ định số lượng yêu cầu mà một địa chỉ IP cụ thể có thể thực hiện trong một khoảng thời gian xác định.</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">limiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">RateLimiter</span><span class="p">();</span>
<span class="nx">limiter</span><span class="p">.</span><span class="nx">addLimit</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">500</span><span class="p">);</span><span class="w"> </span><span class="c1">// login page can be requested 5 times at max within 500 seconds</span>
</code></pre></div>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Credential_Stuffing_Prevention_Cheat_Sheet.html#captcha">Sử dụng CAPTCHA</a> cũng là một cơ chế phổ biến khác được sử dụng để chống lại brute-forcing. Có các mô-đun được phát triển cho Node.js CAPTCHA. Một mô-đun phổ biến được sử dụng trong các ứng dụng Node.js là <a href="https://www.npmjs.com/package/svg-captcha">svg-captcha</a>. Nó có thể được sử dụng như sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">svgCaptcha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;svg-captcha&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/captcha&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">captcha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">svgCaptcha</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="w">    </span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">captcha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">captcha</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="nx">captcha</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#account-lockout">Account lockout</a> là một giải pháp được đề xuất để giữ cho kẻ tấn công tránh xa người dùng hợp lệ của bạn. Có thể khóa tài khoản với nhiều mô-đun như <a href="https://www.npmjs.com/package/mongoose">mongoose</a>. Bạn có thể tham khảo <a href="http://devsmash.com/blog/implementing-max-login-attempts-with-mongoose">bài đăng trên blog này</a> để xem cách khóa tài khoản được thực hiện trong.</p>
<h4 id="use-anti-csrf-tokens">Use Anti-CSRF tokens<a class="headerlink" href="#use-anti-csrf-tokens" title="Permanent link">&para;</a></h4>
<p><a href="https://owasp.org/www-community/attacks/csrf">Cross-Site Request Forgery (CSRF)</a> nhằm mục đích thực hiện các hành động được ủy quyền thay mặt cho người dùng được xác thực, trong khi người dùng không biết về hành động này. Các cuộc tấn công CSRF thường được thực hiện cho các yêu cầu thay đổi trạng thái như thay đổi mật khẩu, thêm người dùng hoặc đặt hàng. <a href="https://www.npmjs.com/package/csurf">Csurf</a> là một phần mềm trung gian nhanh đã được sử dụng để giảm thiểu các cuộc tấn công CSRF. Nhưng một lỗ hổng bảo mật trong gói này gần đây đã được phát hiện. Nhóm đằng sau gói chưa khắc phục lỗ hổng được phát hiện và họ đã đánh dấu gói là không dùng nữa, khuyến nghị sử dụng bất kỳ gói bảo vệ CSRF nào khác.</p>
<p>Để biết thông tin chi tiết về các cuộc tấn công giả mạo yêu cầu chéo trang web (CSRF) và các phương pháp ngăn chặn, bạn có thể tham khảo <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">Cross-Site Request Forgery Prevention</a>.</p>
<h4 id="remove-unnecessary-routes">Remove unnecessary routes<a class="headerlink" href="#remove-unnecessary-routes" title="Permanent link">&para;</a></h4>
<p>Một ứng dụng web không nên chứa bất kỳ trang nào không được người dùng sử dụng, vì nó có thể làm tăng bề mặt tấn công của ứng dụng. Do đó, tất cả các tuyến API không sử dụng nên bị vô hiệu hóa trong các ứng dụng Node.js. Điều này đặc biệt xảy ra trong các framework như <a href="https://sailsjs.com">Sails</a> và <a href="https://feathersjs.com">Feathers</a>, vì chúng tự động tạo các điểm cuối REST API. Ví dụ: Trong <a href="https://sailsjs.com">Sails</a>, nếu URL không khớp với tuyến đường tùy chỉnh, URL đó có thể khớp với một trong các tuyến đường tự động và vẫn tạo phản hồi. Tình huống này có thể dẫn đến các kết quả khác nhau, từ rò rỉ thông tin đến thực thi lệnh tùy ý. Do đó, trước khi sử dụng các khung và mô-đun như vậy, điều quan trọng là phải biết các tuyến mà chúng tự động tạo và xóa hoặc vô hiệu hóa các tuyến này.</p>
<h4 id="prevent-http-parameter-pollution">Prevent HTTP Parameter Pollution<a class="headerlink" href="#prevent-http-parameter-pollution" title="Permanent link">&para;</a></h4>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution.html">HTTP Parameter Pollution(HPP)</a> là một cuộc tấn công trong đó kẻ tấn công gửi nhiều tham số HTTP có cùng tên và điều này khiến ứng dụng của bạn diễn giải chúng một cách không thể đoán trước. Khi nhiều giá trị tham số được gửi, Express sẽ điền chúng vào một mảng. Để giải quyết vấn đề này, bạn có thể sử dụng mô-đun <a href="https://www.npmjs.com/package/hpp">hpp</a> module. Khi được sử dụng, mô-đun này sẽ bỏ qua tất cả các giá trị được gửi cho một tham số trong <code>req.query</code> and/or <code>req.body</code> và chỉ chọn giá trị tham số cuối cùng được gửi. Bạn có thể sử dụng nó như sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">hpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;hpp&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">hpp</span><span class="p">());</span>
</code></pre></div>
<h4 id="only-return-what-is-necessary">Only return what is necessary<a class="headerlink" href="#only-return-what-is-necessary" title="Permanent link">&para;</a></h4>
<p>Thông tin về người dùng của một ứng dụng là một trong những thông tin quan trọng nhất về ứng dụng. Bảng người dùng thường bao gồm các trường như id, tên người dùng, tên đầy đủ, địa chỉ email, ngày sinh, mật khẩu và trong một số trường hợp số an sinh xã hội. Do đó, khi truy vấn và sử dụng các đối tượng người dùng, bạn chỉ cần trả về các trường cần thiết vì nó có thể dễ bị tiết lộ thông tin cá nhân. Điều này cũng đúng đối với các đối tượng khác được lưu trữ trên cơ sở dữ liệu. Nếu bạn chỉ cần một trường nhất định của một đối tượng, bạn chỉ nên trả về các trường cụ thể được yêu cầu. Ví dụ: bạn có thể sử dụng một hàm như sau bất cứ khi nào bạn cần lấy thông tin về người dùng. Bằng cách đó, bạn chỉ có thể trả về các trường cần thiết cho hoạt động cụ thể của mình. Nói cách khác, nếu bạn chỉ cần liệt kê tên của những người dùng có sẵn, bạn sẽ không trả lại địa chỉ email hoặc số thẻ tín dụng của họ ngoài tên đầy đủ của họ.</p>
<div class="highlight"><pre><span></span><code><span class="nx">exports</span><span class="p">.</span><span class="nx">sanitizeUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
<span class="w">    </span><span class="nx">username</span><span class="o">:</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
<span class="w">    </span><span class="nx">fullName</span><span class="o">:</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">fullName</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>
</code></pre></div>
<h4 id="use-object-property-descriptors">Use object property descriptors<a class="headerlink" href="#use-object-property-descriptors" title="Permanent link">&para;</a></h4>
<p>Thuộc tính đối tượng bao gồm ba thuộc tính ẩn: <code>writable</code> (nếu false, giá trị thuộc tính không thể thay đổi), <code>enumerable</code> (nếu false, thuộc tính không thể được sử dụng cho các vòng lặp) và <code>configurable</code> (nếu false, thuộc tính không thể bị xóa). Khi xác định một thuộc tính đối tượng thông qua gán, ba thuộc tính ẩn này được đặt thành true theo mặc định. Các thuộc tính này có thể được đặt như sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">writable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">enumerable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">configurable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span>
<span class="p">});</span>
</code></pre></div>
<p>Ngoài ra, có một số chức năng đặc biệt cho các thuộc tính đối tượng. <code>Object.preventExtensions()</code> ngăn không cho các thuộc tính mới được thêm vào đối tượng.</p>
<h4 id="use-access-control-lists">Use access control lists<a class="headerlink" href="#use-access-control-lists" title="Permanent link">&para;</a></h4>
<p>Ủy quyền ngăn người dùng hành động ngoài quyền dự định của họ. Để làm như vậy, người dùng và vai trò của họ nên được xác định với việc xem xét nguyên tắc đặc quyền tối thiểu. Mỗi vai trò người dùng chỉ nên có quyền truy cập vào các tài nguyên mà họ phải sử dụng. Đối với các ứng dụng Node.js của bạn, bạn có thể sử dụng mô-đun <a href="https://www.npmjs.com/package/acl">acl</a> để cung cấp triển khai ACL (danh sách kiểm soát truy cập). Với mô-đun này, bạn có thể tạo vai trò và gán người dùng cho các vai trò này.</p>
<h3 id="error-exception-handling">Error &amp; Exception Handling<a class="headerlink" href="#error-exception-handling" title="Permanent link">&para;</a></h3>
<h4 id="handle-uncaughtexception">Handle uncaughtException<a class="headerlink" href="#handle-uncaughtexception" title="Permanent link">&para;</a></h4>
<p>Node.js hành vi cho các ngoại lệ không bị bắt là in dấu vết ngăn xếp hiện tại và sau đó chấm dứt luồng. Tuy nhiên, Node.js cho phép tùy chỉnh hành vi này. Nó cung cấp một đối tượng toàn cầu có tên là process có sẵn cho tất cả các ứng dụng Node.js. Nó là một đối tượng EventEmitter và trong trường hợp ngoại lệ không bị bắt, sự kiện uncaughtException được phát ra và nó được đưa lên vòng lặp sự kiện chính. Để cung cấp hành vi tùy chỉnh cho các trường hợp ngoại lệ không bị bắt, bạn có thể liên kết với sự kiện này. Tuy nhiên, việc tiếp tục ứng dụng sau một ngoại lệ không bị bắt như vậy có thể dẫn đến các vấn đề khác. Do đó, nếu bạn không muốn bỏ lỡ bất kỳ ngoại lệ chưa bị bắt nào, bạn nên liên kết với sự kiện uncaughtException và dọn dẹp mọi tài nguyên được phân bổ như mô tả tệp, xử lý và tương tự trước khi tắt quy trình. Việc tiếp tục ứng dụng không được khuyến khích vì ứng dụng sẽ ở trạng thái không xác định. Điều quan trọng cần lưu ý là khi hiển thị thông báo lỗi cho người dùng trong trường hợp ngoại lệ không bị bắt, thông tin chi tiết như dấu vết ngăn xếp không nên được tiết lộ cho người dùng. Thay vào đó, các thông báo lỗi tùy chỉnh sẽ được hiển thị cho người dùng để không gây ra bất kỳ rò rỉ thông tin nào.</p>
<div class="highlight"><pre><span></span><code><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;uncaughtException&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// clean up allocated resources</span>
<span class="w">    </span><span class="c1">// log necessary error details to log files</span>
<span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">();</span><span class="w"> </span><span class="c1">// exit the process to avoid unknown state</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="listen-to-errors-when-using-eventemitter">Listen to errors when using EventEmitter<a class="headerlink" href="#listen-to-errors-when-using-eventemitter" title="Permanent link">&para;</a></h4>
<p>Khi sử dụng EventEmitter, lỗi có thể xảy ra ở bất kỳ đâu trong chuỗi sự kiện. Thông thường, nếu một lỗi xảy ra trong một đối tượng EventEmitter, một sự kiện lỗi có một đối tượng Error làm đối số được gọi. Tuy nhiên, nếu không có người nghe đính kèm vào sự kiện lỗi đó, đối tượng Lỗi được gửi dưới dạng đối số sẽ bị ném và trở thành ngoại lệ không bị bắt. Nói tóm lại, nếu bạn không xử lý lỗi trong một đối tượng EventEmitter đúng cách, những lỗi chưa được xử lý này có thể làm sập ứng dụng của bạn. Do đó, bạn nên luôn lắng nghe các sự kiện lỗi khi sử dụng các đối tượng EventEmitter.</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;events&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">myEventEmitter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">events</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">require</span><span class="p">(</span><span class="s1">&#39;util&#39;</span><span class="p">).</span><span class="nx">inherits</span><span class="p">(</span><span class="nx">myEventEmitter</span><span class="p">,</span><span class="w"> </span><span class="nx">events</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">);</span>
<span class="nx">myEventEmitter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">someFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">param1</span><span class="p">,</span><span class="w"> </span><span class="nx">param2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//in case of an error</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">emitter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">myEventEmitter</span><span class="p">();</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
<span class="w">    </span><span class="c1">//Perform necessary error handling here</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="handle-errors-in-asynchronous-calls">Handle errors in asynchronous calls<a class="headerlink" href="#handle-errors-in-asynchronous-calls" title="Permanent link">&para;</a></h4>
<p>Các lỗi xảy ra trong callback không đồng bộ rất dễ bị bỏ lỡ. Do đó, như một nguyên tắc chung, đối số đầu tiên cho các cuộc gọi không đồng bộ phải là một đối tượng Lỗi. Ngoài ra, các tuyến tốc hành tự xử lý lỗi, nhưng cần luôn nhớ rằng các lỗi xảy ra trong các cuộc gọi không đồng bộ được thực hiện trong các tuyến tốc hành không được xử lý, trừ khi một đối tượng Lỗi được gửi dưới dạng đối số đầu tiên.</p>
<p>Lỗi trong các callback này có thể được lan truyền nhiều lần nhất có thể. Mỗi callback mà lỗi đã được lan truyền có thể bỏ qua, xử lý hoặc lan truyền lỗi.</p>
<h3 id="server-security">Server Security<a class="headerlink" href="#server-security" title="Permanent link">&para;</a></h3>
<h4 id="set-cookie-flags-appropriately">Set cookie flags appropriately<a class="headerlink" href="#set-cookie-flags-appropriately" title="Permanent link">&para;</a></h4>
<p>Nói chung, thông tin phiên được gửi bằng cookie trong các ứng dụng web. Tuy nhiên, việc sử dụng cookie HTTP không đúng cách có thể khiến ứng dụng gặp một số lỗ hổng quản lý phiên. Một số cờ có thể được đặt cho mỗi cookie để ngăn chặn các loại tấn công này. Cờ <code>httpOnly</code>, <code>Secure</code> và <code>SameSite</code> rất quan trọng đối với cookie phiên. Cờ <code>httpOnly</code> ngăn không cho cookie được truy cập bởi JavaScript phía máy khách. Đây là một biện pháp đối phó hiệu quả cho các cuộc tấn công XSS. Cờ <code>Secure</code> chỉ cho phép cookie được gửi nếu giao tiếp qua HTTPS. Cờ <code>SameSite</code> có thể ngăn cookie được gửi trong các yêu cầu chéo trang web giúp bảo vệ chống lại các cuộc tấn công Giả mạo Yêu cầu Chéo Trang web (CSRF). Ngoài ra, còn có các cờ khác như <code>domain</code>, <code>path</code> and <code>expires</code>. Việc đặt các cờ này một cách thích hợp được khuyến khích, nhưng chúng chủ yếu liên quan đến phạm vi cookie chứ không phải bảo mật cookie. Việc sử dụng mẫu các cờ này được đưa ra trong ví dụ sau:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-session&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">session</span><span class="p">({</span>
<span class="w">    </span><span class="nx">secret</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;your-secret-key&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;cookieName&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">cookie</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">secure</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">httpOnly</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;/user&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sameSite</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}</span>
<span class="p">}));</span>
</code></pre></div>
<h4 id="use-appropriate-security-headers">Use appropriate security headers<a class="headerlink" href="#use-appropriate-security-headers" title="Permanent link">&para;</a></h4>
<p>Có một số <a href="https://owasp.org/www-project-secure-headers/">HTTP security headers</a> có thể giúp bạn ngăn chặn một số vectơ tấn công phổ biến.
Gói <a href="https://www.npmjs.com/package/helmet">helmet</a> có thể giúp thiết lập các tiêu đề đó:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;express&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">helmet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;helmet&quot;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">());</span><span class="w"> </span><span class="c1">// Add various HTTP headers</span>
</code></pre></div>
<p>Gói <code>helmet</code> cơ bản sử dụng 14 middlewares nhỏ.
Dưới đây là danh sách các tiêu đề bảo mật HTTP được bao phủ bởi <code>helmet</code> middleware:</p>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">Strict-Transport-Security</a></strong>: <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html">HTTP Strict Transport Security (HSTS)</a> ra lệnh cho các trình duyệt rằng ứng dụng chỉ có thể được truy cập thông qua các kết nối HTTPS. Để sử dụng nó trong ứng dụng của bạn, hãy thêm các mã sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hsts</span><span class="p">());</span><span class="w"> </span><span class="c1">// default configuration</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
<span class="w">  </span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hsts</span><span class="p">({</span>
<span class="w">    </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123456</span><span class="p">,</span>
<span class="w">    </span><span class="nx">includeSubDomains</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">);</span><span class="w"> </span><span class="c1">// custom configuration</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">X-Frame-Options</a>:</strong> xác định xem một trang có thể được tải qua một <code>&lt;frame&gt;</code> hoặc phần tử <code>&lt;iframe&gt;</code> hay không. Cho phép trang được đóng khung có thể dẫn đến các cuộc tấn công <a href="https://owasp.org/www-community/attacks/Clickjacking">Clickjacking</a>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">frameguard</span><span class="p">());</span><span class="w"> </span><span class="c1">// default behavior (SAMEORIGIN)</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection">X-XSS-Protection</a>:</strong>  ngăn các trang tải khi chúng phát hiện các cuộc tấn công cross-site scripting (XSS) được phản xạ. Tiêu đề này đã bị các trình duyệt hiện đại phản đối và việc sử dụng nó có thể gây ra các vấn đề bảo mật bổ sung ở phía máy khách. Do đó, nên đặt tiêu đề là <strong>X-XSS-Protection: 0</strong> để vô hiệu hóa XSS Auditor và không cho phép nó thực hiện hành vi mặc định của trình duyệt xử lý phản hồi.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">xssFilter</span><span class="p">());</span><span class="w"> </span><span class="c1">// sets &quot;X-XSS-Protection: 0&quot;</span>
</code></pre></div>
<p>Đối với các trình duyệt hiện đại, bạn nên triển khai chính sách <strong>Content-Security-Policy</strong> mạnh mẽ, như được nêu chi tiết trong phần tiếp theo.</p>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">Content-Security-Policy</a>:</strong> Chính sách bảo mật nội dung được phát triển để giảm nguy cơ bị tấn công như <a href="https://owasp.org/www-community/attacks/xss/">Cross-Site Scripting (XSS)</a> và <a href="https://owasp.org/www-community/attacks/Clickjacking">Clickjacking</a>. Nó cho phép nội dung từ một danh sách mà bạn quyết định. Nó có một số chỉ thị, mỗi chỉ thị cấm tải loại nội dung cụ thể. Bạn có thể tham khảo <a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html">Content Security Policy Cheat Sheet</a> để được giải thích chi tiết về từng chỉ thị và cách sử dụng nó. Bạn có thể triển khai các cài đặt này trong ứng dụng của mình như sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
<span class="w">  </span><span class="nx">helmet</span><span class="p">.</span><span class="nx">contentSecurityPolicy</span><span class="p">({</span>
<span class="w">    </span><span class="c1">// the following directives will be merged into the default helmet CSP policy</span>
<span class="w">    </span><span class="nx">directives</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">defaultSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">],</span><span class="w">  </span><span class="c1">// default value for all directives that are absent</span>
<span class="w">      </span><span class="nx">scriptSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">],</span><span class="w">   </span><span class="c1">// helps prevent XSS attacks</span>
<span class="w">      </span><span class="nx">frameAncestors</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">],</span><span class="w">  </span><span class="c1">// helps prevent Clickjacking attacks</span>
<span class="w">      </span><span class="nx">imgSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&#39;http://imgexample.com&#39;&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nx">styleSrc</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">);</span>
</code></pre></div>
<p>Vì middleware này thực hiện rất ít validation, nên dựa vào các trình kiểm tra CSP như <a href="https://csp-evaluator.withgoogle.com/">CSP Evaluator</a> để thay thế.</p>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options</a>:</strong> Ngay cả khi máy chủ đặt tiêu đề <code>Content-Type</code> hợp lệ trong phản hồi, trình duyệt có thể cố gắng đánh hơi loại MIME của tài nguyên được yêu cầu. Tiêu đề này là một cách để ngăn chặn hành vi này và yêu cầu trình duyệt không thay đổi loại MIME được chỉ định trong tiêu đề <code>Content-Type</code>. Nó có thể được cấu hình theo cách sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">noSniff</span><span class="p">());</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control">Cache-Control</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Pragma">Pragma</a>:</strong> Tiêu đề Cache-Control có thể được sử dụng để ngăn các trình duyệt lưu vào bộ nhớ đệm các phản hồi đã cho. Điều này nên được thực hiện cho các trang có chứa thông tin nhạy cảm về người dùng hoặc ứng dụng. Tuy nhiên, việc tắt bộ nhớ đệm cho các trang không chứa thông tin nhạy cảm có thể ảnh hưởng nghiêm trọng đến hiệu suất của ứng dụng. Do đó, chỉ nên tắt bộ nhớ đệm cho các trang trả về thông tin nhạy cảm. Các điều khiển và tiêu đề bộ nhớ đệm thích hợp có thể được đặt dễ dàng bằng gói <a href="https://www.npmjs.com/package/nocache">nocache</a>:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">nocache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;nocache&quot;</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">nocache</span><span class="p">());</span>
</code></pre></div>
<p>Đoạn code trên sets Cache-Control, Surrogate-Control, Pragma và Expires cho phù hợp.</p>
<ul>
<li><strong>X-Download-Options:</strong> Tiêu đề này ngăn Internet Explorer thực thi các tệp đã tải xuống trong ngữ cảnh của trang web. Điều này đạt được với chỉ thị noopen. Bạn có thể làm như vậy với đoạn mã sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">ieNoOpen</span><span class="p">());</span>
</code></pre></div>
<ul>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT">Expect-CT</a>:</strong> Tính minh bạch của chứng chỉ (Certificate Transparency) là một cơ chế mới được phát triển để khắc phục một số vấn đề cấu trúc liên quan đến cơ sở hạ tầng SSL hiện tại. Tiêu đề Expect-CT có thể thực thi các yêu cầu về tính minh bạch của chứng chỉ. Nó có thể được triển khai trong ứng dụng của bạn như sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">expectCt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;expect-ct&#39;</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">expectCt</span><span class="p">({</span><span class="w"> </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123</span><span class="w"> </span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">expectCt</span><span class="p">({</span><span class="w"> </span><span class="nx">enforce</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123</span><span class="w"> </span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">expectCt</span><span class="p">({</span><span class="w"> </span><span class="nx">enforce</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">maxAge</span><span class="o">:</span><span class="w"> </span><span class="mf">123</span><span class="p">,</span><span class="w"> </span><span class="nx">reportUri</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://example.com&#39;</span><span class="p">}));</span>
</code></pre></div>
<ul>
<li><strong>X-Powered-By:</strong> X-Powered-By header được sử dụng để thông báo công nghệ nào được sử dụng ở phía máy chủ. Đây là một tiêu đề không cần thiết gây rò rỉ thông tin, vì vậy nó nên được loại bỏ khỏi ứng dụng của bạn. Để làm như vậy, bạn có thể sử dụng <code>hidePoweredBy</code> như sau:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hidePoweredBy</span><span class="p">());</span>
</code></pre></div>
<p>Ngoài ra, bạn có thể nói dối về các công nghệ được sử dụng với headers này. Ví dụ: ngay cả khi ứng dụng của bạn không sử dụng PHP, bạn cũng có thể đặt headers <code>X-Powered-By</code></p>
<div class="highlight"><pre><span></span><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">helmet</span><span class="p">.</span><span class="nx">hidePoweredBy</span><span class="p">({</span><span class="w"> </span><span class="nx">setTo</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PHP 4.2.0&#39;</span><span class="w"> </span><span class="p">}));</span>
</code></pre></div>
<h3 id="platform-security">Platform Security<a class="headerlink" href="#platform-security" title="Permanent link">&para;</a></h3>
<h4 id="keep-your-packages-up-to-date">Keep your packages up-to-date<a class="headerlink" href="#keep-your-packages-up-to-date" title="Permanent link">&para;</a></h4>
<p>Tính bảo mật của ứng dụng phụ thuộc trực tiếp vào mức độ an toàn của các gói bên thứ ba mà bạn sử dụng trong ứng dụng của mình. Do đó, điều quan trọng là phải cập nhật các gói của bạn. Cần lưu ý rằng <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities">Sử dụng các thành phần có lỗ hổng</a> đã biết vẫn nằm trong Top 10 của OWASP. Bạn có thể sử dụng OWASP <a href="https://jeremylong.github.io/DependencyCheck/analyzers/nodejs.html">OWASP Dependency-Check</a> để xem liệu có bất kỳ gói nào được sử dụng trong dự án có lỗ hổng đã biết hay không. Ngoài ra, bạn có thể sử dụng <a href="https://github.com/retirejs/retire.js/">Retire.js</a> để kiểm tra các thư viện JavaScript có lỗ hổng đã biết.</p>
<p>Bắt đầu với phiên bản 6, <code>npm</code> đã giới thiệu <code>audit</code>, sẽ cảnh báo về các gói dễ bị tấn công:</p>
<div class="highlight"><pre><span></span><code>npm<span class="w"> </span>audit
</code></pre></div>
<p><code>npm</code> cũng giới thiệu một cách đơn giản để nâng cấp các gói bị ảnh hưởng:</p>
<div class="highlight"><pre><span></span><code>npm<span class="w"> </span>audit<span class="w"> </span>fix
</code></pre></div>
<p>Có một số công cụ khác mà bạn có thể sử dụng để kiểm tra các phụ thuộc của mình. Một danh sách toàn diện hơn có thể được tìm thấy trong <a href="https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html#tools">Vulnerable Dependency Management CS</a>.</p>
<h4 id="do-not-use-dangerous-functions">Do not use dangerous functions<a class="headerlink" href="#do-not-use-dangerous-functions" title="Permanent link">&para;</a></h4>
<p>Có một số hàm JavaScript nguy hiểm và chỉ nên được sử dụng khi cần thiết hoặc không thể tránh khỏi. Ví dụ đầu tiên là hàm <code>eval()</code>. Hàm này lấy một đối số chuỗi và thực thi nó như bất kỳ mã nguồn JavaScript nào khác. Kết hợp với đầu vào của người dùng, hành vi này vốn dẫn đến lỗ hổng thực thi mã từ xa. Tương tự, các cuộc gọi đến <code>child_process.exec</code> cũng rất nguy hiểm. Hàm này hoạt động như một trình thông dịch bash và gửi các đối số của nó đến /bin/sh. Bằng cách tiêm đầu vào cho chức năng này, kẻ tấn công có thể thực hiện các lệnh tùy ý trên máy chủ.</p>
<p>Ngoài các chức năng này, một số mô-đun yêu cầu sự chăm sóc đặc biệt khi được sử dụng. Ví dụ, mô-đun <code>fs</code> xử lý các hoạt động của hệ thống tệp. Tuy nhiên, nếu đầu vào người dùng được khử trùng không đúng cách được đưa vào mô-đun này, ứng dụng của bạn có thể trở nên dễ bị tổn thương bởi các lỗ hổng bao gồm tệp và truyền thư mục. Tương tự, mô-đun <code>vm</code> cung cấp API để biên dịch và chạy mã trong ngữ cảnh Máy ảo V8. Vì nó có thể thực hiện các hành động nguy hiểm tự nhiên, nó nên được sử dụng trong hộp cát.</p>
<p>Sẽ không công bằng khi nói rằng các chức năng và mô-đun này không nên được sử dụng, tuy nhiên, chúng nên được sử dụng cẩn thận, đặc biệt là khi chúng sử dụng với đầu vào của người dùng. Ngoài ra, <a href="https://github.com/wisec/domxsswiki/wiki/Direct-Execution-Sinks">có một số chức năng khác</a> có thể khiến ứng dụng của bạn dễ bị tấn công.</p>
<h4 id="stay-away-from-evil-regexes">Stay away from evil regexes<a class="headerlink" href="#stay-away-from-evil-regexes" title="Permanent link">&para;</a></h4>
<p>Từ chối dịch vụ biểu thức chính quy (ReDoS) là một cuộc tấn công từ chối dịch vụ, khai thác thực tế là hầu hết các triển khai Biểu thức chính quy có thể đạt đến các tình huống cực đoan khiến chúng hoạt động rất chậm (liên quan theo cấp số nhân đến kích thước đầu vào). Kẻ tấn công sau đó có thể gây ra một chương trình sử dụng Biểu thức chính quy để nhập các tình huống cực đoan này và sau đó bị treo trong một thời gian rất dài.</p>
<p><a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">Từ chối dịch vụ biểu thức chính quy (ReDoS)</a> là một loại tấn công Từ chối Dịch vụ sử dụng các biểu thức chính quy. Một số triển khai Biểu thức Chính quy (Regex) có thể gây ra các tình huống cực đoan khiến ứng dụng chạy rất chậm. Kẻ tấn công có thể khai thác các triển khai regex này để đưa ứng dụng vào những tình huống cực đoan và khiến nó bị treo trong thời gian dài. Những regex như vậy được gọi là 'evil' (ác ý) nếu ứng dụng có thể bị kẹt bởi đầu vào được tạo tinh vi. Thông thường, những regex này bị khai thác bằng cách nhóm với sự lặp lại và sự thay thế có sự chồng chéo. Ví dụ, biểu thức chính quy sau đây <code>^(([a-z])+.)+A-Z+$</code> có thể được sử dụng để chỉ định tên lớp Java. Tuy nhiên, một chuỗi rất dài (aaaa...aaaaAaaaaa...aaaa) cũng có thể khớp với biểu thức chính quy này. Có một số công cụ kiểm tra xem liệu một regex có tiềm năng gây ra tấn công từ chối dịch vụ hay không. Một ví dụ là <a href="https://github.com/davisjam/vuln-regex-detector">vuln-regex-detector</a>.</p>
<h4 id="run-security-linters">Run security linters<a class="headerlink" href="#run-security-linters" title="Permanent link">&para;</a></h4>
<p>Khi phát triển mã, việc ghi nhớ tất cả các mẹo bảo mật có thể rất khó khăn. Hơn nữa, đảm bảo tất cả thành viên trong nhóm tuân thủ các quy tắc này gần như là không thể. Đây là lý do tại sao có các công cụ Kiểm tra Bảo mật Tĩnh (SAST). Những công cụ này không thực thi mã của bạn, mà đơn giản là tìm kiếm các mẫu có thể chứa rủi ro bảo mật. Vì JavaScript là ngôn ngữ động và kiểu dữ liệu không chặt chẽ, các công cụ linting thực sự rất quan trọng trong vòng đời phát triển phần mềm. Các quy tắc linting cần được xem xét định kỳ và các phát hiện cần được kiểm tra kỹ lưỡng. Một lợi thế khác của các công cụ này là tính năng cho phép bạn thêm các quy tắc tùy chỉnh cho các mẫu mà bạn cho là nguy hiểm. <a href="http://jshint.com/">JSHint</a> và <a href="http://jshint.com/">JSHint</a> là những công cụ SAST được sử dụng phổ biến để linting JavaScript.</p>
<h4 id="use-strict-mode">Use strict mode<a class="headerlink" href="#use-strict-mode" title="Permanent link">&para;</a></h4>
<p>JavaScript có một số tính năng cũ không an toàn và nguy hiểm mà không nên sử dụng. Để loại bỏ những tính năng này, ES5 đã giới thiệu chế độ nghiêm ngặt (strict mode) dành cho các nhà phát triển. Với chế độ này, các lỗi trước đây bị bỏ qua sẽ được ném ra. Nó cũng giúp các engine JavaScript thực hiện tối ưu hóa. Với chế độ nghiêm ngặt, những cú pháp xấu mà trước đây được chấp nhận sẽ gây ra lỗi thực sự. Vì những cải tiến này, bạn nên luôn sử dụng chế độ nghiêm ngặt trong ứng dụng của mình. Để bật chế độ nghiêm ngặt, bạn chỉ cần viết <code>"use strict";</code> ở đầu đoạn mã của mình.</p>
<p>Đoạn mã sau đây sẽ tạo ra lỗi ReferenceError: Can't find variable: y trên bảng điều khiển, lỗi này sẽ không hiển thị nếu không sử dụng chế độ nghiêm ngặt:</p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">func</span><span class="p">();</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.14</span><span class="p">;</span><span class="w">   </span><span class="c1">// This will cause an error (y is not defined)</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="adhere-to-general-application-security-principles">Adhere to general application security principles<a class="headerlink" href="#adhere-to-general-application-security-principles" title="Permanent link">&para;</a></h4>
<p>Danh sách này chủ yếu tập trung vào các vấn đề thường gặp trong các ứng dụng Node.js, cùng với các khuyến nghị và ví dụ. Ngoài ra, còn có các <a href="https://wiki.owasp.org/index.php/Security_by_Design_Principles">nguyên tắc bảo mật theo thiết kế</a> áp dụng cho các ứng dụng web bất kể công nghệ nào được sử dụng trên máy chủ ứng dụng. Bạn cũng nên ghi nhớ những nguyên tắc này khi phát triển ứng dụng của mình. Bạn có thể tham khảo <a href="https://cheatsheetseries.owasp.org/">OWASP Cheat Sheet Series</a> để tìm hiểu thêm về các lỗ hổng bảo mật của ứng dụng web và các kỹ thuật giảm thiểu rủi ro.</p>
<h2 id="additional-resources-about-nodejs-security">Additional resources about Node.js security<a class="headerlink" href="#additional-resources-about-nodejs-security" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/lirantal/awesome-nodejs-security">Awesome Node.js Security resources</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©Copyright <script>document.write(new Date().getFullYear())</script> - Cheat Sheets Series Team - This work is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>